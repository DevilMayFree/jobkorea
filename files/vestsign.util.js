var VestSign=function(e){return e}(function(){"use strict";var e=void 0;if(window.opener){if("undefined"!=typeof window.opener.vestSign&&""!=window.opener.vestSign)return window.opener.vestSign}else{if(!window.parent.vestSign)return e;if("undefined"!=typeof window.parent.vestSign&&""!=window.parent.vestSign)return window.parent.vestSign}}());!function(e,t,n){"use strict";function r(e){return yt.util.bytesToHex(yt.util.decode64(e))}function i(e){return yt.util.encode64(yt.util.hexToBytes(e))}function o(e){return yt.util.encode64(e)}function s(e){return yt.util.decode64(e)}function a(e,t){var n,r=0,i="",o=0;if(n=e.split(","),o=n.length,""==t)return o;for(;"undefined"!=typeof n[r];){if(i=n[r].split("="),i[0].toLowerCase().trim()==t.toLowerCase())return i[1];r++}return o}var u=function(n){var r,i=e.localStorage,o=e.sessionStorage;if(t.isUndefined(Storage))throw"No web storage support";this.setStorage=function(e){switch(e){case u.TYPE.LOCALSTORAGE:r=i;break;case u.TYPE.SESSIONSTORAGE:r=o;break;default:throw"Not supported storage"}},this.set=function(e,n,i,o){if(arguments.length<2)throw"2 arguments required, but only "+arguments.length;r.setItem(e,n),(i||t.noop)()},this.get=function(e,n,i){if(arguments.length<1)throw"key required";(n||t.noop)(r.getItem(e))}};u.TYPE={LOCALSTORAGE:1,SESSIONSTORAGE:2};var c={hasFileAPI:function(){return t.isDefined(e.File)&&t.isDefined(e.FileReader)&&t.isDefined(e.Blob)},read:function(e,n){if(!t.isFile(e))throw"invalid arguments: not File object";var r=new FileReader;r.onload=function(){(n||t.noop)(r.result)},r.readAsArrayBuffer(e)},getPFXUrl:function(e){return"data:application/x-pkcs12;base64,"+yt.util.encode64(e)},download:function(t,n){var r,i,o,s,a="msSaveBlob";r=new ArrayBuffer(n.length),i=new Uint8Array(r);for(var u=i.length;u--;)i[u]=n[u].charCodeAt(0);o=new Blob([i],{type:"application/octet-stream"}),s=e.document.createElement("a"),a in e.navigator?s.onclick=e.navigator.msSaveBlob(o,t):s.href=e.URL.createObjectURL(o),s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}},d={versionCheck:function(e,t){for(var n=e.split("."),r=t.split("."),i=0;i<r.length;i++){if(parseInt(n[i])<parseInt(r[i]))return!1;if(parseInt(n[i])>parseInt(r[i]))return!0}return!0},availableVersion:function(e,t){if(""==e)return!1;for(var n=e.split("."),r=t.split("."),i=0;i<r.length;i++){if(parseInt(n[i])<parseInt(r[i]))return!1;if(parseInt(n[i])>parseInt(r[i]))return!0}return!0},getVersion:function(e,n){var r;return t.forEach(n,function(t){t.moduleName===e&&(r=t.version)}),r}},l={center:function(e){var n,r,i,o,s,a;i=parent.window.innerWidth?parent.window.innerWidth:parent.document.documentElement.clientWidth?parent.document.documentElement.clientWidth:screen.width,o=parent.window.innerHeight?parent.window.innerHeight:parent.document.documentElement.clientHeight?parent.document.documentElement.clientHeight:screen.height,s=parent.window.outerWidth,a=parent.window.outerHeight,n="undefined"!=typeof parent.window.screenLeft&&"unknown"!=typeof parent.window.screenLeft?parent.window.screenLeft:parent.window.screenX,r="undefined"!=typeof parent.window.screenTop&&"unknown"!=typeof parent.window.screenTop?parent.window.screenTop:parent.window.screenY,t.browser.isMSIE()||(n+=s-i,r+=a-o),e.center={x:i/2+n,y:o/2+r}}},f={convertMsg:function(e){var r=t.error.getErrorMessage(e.code,VestSign.getConfig().langIndex);if("undefined"==r&&"object"==typeof e.getReason()){r=e.getReason()+"";var i=r.indexOf("reason:");i!=-1&&(r=r.substring(i+7))}var o;if(!VestSign.getConfig().useBracket&&r.indexOf("(")!=-1){var i=r.indexOf("(");o=r.substring(0,i)+"."}e.msg=(o!==n?o:r)+" ["+e.code+"]"},koreaMintLibErrorHandler:function(e){var n=t.error.getMobileErrorMessage(e,VestSign.getConfig().langIndex);return n+" ["+e+"]"}},g=function(e){e.storageType!=n&&delete e.storageType,e.serial!=n&&delete e.serial,e.caType!=n&&delete e.caType},p=function(){var t=e.navigator.userAgent,n=t.indexOf("MSIE");return n>0?parseInt(t.substring(n+5,t.indexOf(".",n))):0},m=function(e,n,r,i){var o=function(e,n){if("undefined"!=typeof e.type&&"number"==typeof e.type){var r=t.decryptKeySafer(e.type,e.config);r.getDecryptedPassword(e.value,n)}else n(e)},s=function(e){return!(e.length<10||e.length>30)},a=function(e){return e.indexOf('"')==-1&&e.indexOf("'")==-1&&e.indexOf("|")==-1&&e.indexOf("\\")==-1},u=function(e){for(var t=function(e){var t=/^[a-zA-Z]+$/;return!!t.test(e)},n=function(e){var t=/^[0-9]+$/;return!!t.test(e)},r=0;r<=e.length-4;r++){for(var i=!0,o=r+1;o<r+4;o++)if(e[r]!=e[o]){i=!1;break}if(i)return!1}for(var r=0;r<=e.length-6;r++){for(var i=!0,o=r+2;o<r+6;o+=2)if(e[r]!=e[o]||e[r+1]!=e[o+1]){i=!1;break}if(i)return!1}for(var r=0;r<=e.length-6;r++){for(var i=!0,o=r+3;o<r+6;o+=3)if(e[r]!=e[o]||e[r+1]!=e[o+1]||e[r+2]!=e[o+2]){i=!1;break}if(i)return!1}for(var r=0;r<=e.length-4;r++){for(var i=!0,o=r+1;o<r+4;o++)if(e[o]-e[o-1]!=1){i=!1;break}if(i)return!1}for(var r=0;r<e.length-4;r++){for(var i=!0,o=r+1;o<r+4;o++)if(e[o-1]-e[o]!=1){i=!1;break}if(i)return!1}for(var s=!1,a=!1,u=!1,r=0;r<e.length;r++)t(e[r])?a=!0:n(e[r])?s=!0:u=!0;return!!(s&&a&&u)},c={code:0};o(e,function(e){o(n,function(t){o(r,function(n){t!=n?c={code:2400}:e==t?c={code:2402}:s(t)&&a(t)&&u(t)||(c={code:2401}),i(c)})})})},h=function(){var e,t,n,r=function(){n=parent.document.getElementById("yettie_iframe"),e=n.getAttribute("width"),t=n.getAttribute("height"),e.indexOf("px")!=-1&&t.indexOf("px")!=-1&&(e=e.substr(0,e.length-2),t=t.substr(0,t.length-2))},i=function(){n.setAttribute("width",e),n.setAttribute("height",t),n.style.marginTop="-"+t/2+"px",n.style.marginLeft="-"+e/2+"px",n.contentDocument.getElementById("submit_btn")&&(n.contentDocument.getElementById("submit_btn").focus(),""==n.contentDocument.getElementById("passwordInput").value&&n.contentDocument.getElementById("certDetail_btn")&&n.contentDocument.getElementById("certDetail_btn").focus()),n.contentDocument.getElementById("disableForm")&&(n.contentDocument.getElementById("disableForm").style.zIndex=3),n.contentDocument.body.style.backgroundColor="",n.contentDocument.getElementsByClassName("certWrap")[0].style.backgroundColor=""},o=function(){return{x:e,y:t}},s=function(r,i){if(!(t>=380&&"xkeypad"!=r&&"vikie"!=r))switch(r){case"nprotect":case"npk":n.setAttribute("height","380px"),n.style.marginTop="-190px";break;case"transkey":n.setAttribute("height","300px"),n.style.marginTop="-150px";break;case"xkeypad":var o=1*t+1*i.y+10;i.x>e&&(n.setAttribute("width",i.x+"px"),n.style.marginLeft="-"+i.x/2+"px"),n.setAttribute("height",o+"px"),n.style.marginTop="-"+o/2+"px";break;case"vikie":n.setAttribute("width","800px"),n.clientWidth,n.style.marginLeft="-400px",t<250&&n.setAttribute("height","250px"),n.contentDocument.getElementById("disableForm")&&(n.contentDocument.getElementById("disableForm").style.zIndex=-1),n.setAttribute("height","1000px"),n.contentDocument.body.style.backgroundColor="transparent",n.contentDocument.getElementsByClassName("certWrap")[0].style.backgroundColor="#FFFFFF"}};return{setDefault:r,defaultSize:i,onKeypad:s,offKeypad:i,getDefault:o}}(),y=function(e){function t(e,t){for(var n,r={width:"width",height:"height",marginTop:"marginTop",marginRight:"marginRight",marginBottom:"marginBottom",marginLeft:"marginLeft",paddingTop:"paddingTop",paddingRight:"paddingRight",paddingBottom:"paddingBottom",paddingLeft:"paddingLeft"},i=0;i<e.styleSheets[0].cssRules.length;i++){if("html"==e.styleSheets[0].cssRules[i].selectorText){var o=e.styleSheets[0].cssRules[i].style.fontSize;e.styleSheets[0].cssRules[i].style.fontSize=parseFloat(o)*t+"%"}for(var s in r)"undefined"!=typeof e.styleSheets[0].cssRules[i].style&&""!=e.styleSheets[0].cssRules[i].style[s]&&"string"==typeof e.styleSheets[0].cssRules[i].style[s]&&e.styleSheets[0].cssRules[i].style[s].indexOf("px")!=-1&&(n=parseFloat(e.styleSheets[0].cssRules[i].style[s]),e.styleSheets[0].cssRules[i].style[s]=n*t+"px",s!=r.width&&s!=r.height||(e.styleSheets[0].cssRules[i].style.backgroundSize="cover"))}}var n=parent.document.getElementById("yettie_iframe");if(null!=n){var r,i=parent.document.documentElement.clientHeight,o=parent.document.documentElement.clientWidth,s=n.contentDocument.body.firstElementChild.offsetHeight,a=n.contentDocument.body.firstElementChild.offsetWidth;o/i>2/3?i!=s&&(r=i/s,t(e,r)):o!=a&&(r=o/a,t(e,r)),n.contentDocument.body.style.marginTop=(i-n.contentDocument.body.firstElementChild.offsetHeight)/2+"px",n.contentDocument.documentElement.style.opacity=1}},w=function(e,t){function n(e,t){var n,r=0,i="",o=0;if(n=e.split(","),o=n.length,""==t)return o;for(;"undefined"!=typeof n[r];){if(i=n[r].split("="),i[0].toLowerCase()==t.toLowerCase())return i[1];r++}return o}var r=n(t,""),i=n(e,"cn"),o=n(t,"cn");if(1==o)return!1;if(r>1){if(e.toLowerCase().indexOf(t.toLowerCase())!==-1)return!0}else if(i.indexOf(o)!==-1)return!0;return!1},v=function(e){var t="";return t=e.length>8||(parseInt(e,16)+"").length>=10?e:parseInt(e,16)+""},b={setCookie:function(e,t){var n=e+"="+escape(t);parent.document.cookie=n},removeCookie:function(e){parent.document.cookie=e+"=;"},getCookie:function(e){e+="=";var t="",n=parent.document.cookie,r=n.indexOf(e);if(r!=-1){r+=e.length;var i=n.indexOf(";",r);i==-1&&(i=n.length),t=n.substring(r,i)}return unescape(t)}},S={passwordInputTitle:{ISSUE:"ISSUE",REISSUE:"REISSUE",UPDATECERTIFICATE:"UPDATECERTIFICATE",CHANGEPASSWORD:"CHANGEPASSWORD"}};t&&(t.util=t.util||(t.util={}),t.extend(t.util,{WebStorage:u,file:c,certVersion:d,setObject:l,refactoryMsg:f,checkComplexPassword:m,removeObjectElement:g,getIEVersion:p,size:h,modifyMobileFrame:y,matchedDn:w,serialFilterForKoscom:v,cookie:b,base64ToHex:r,hexToBase64:i,encode64:o,decode64:s,certificateSubjectDNField:a,title:S}))}(window,vest);