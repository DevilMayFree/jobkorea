(function(global) {
"undefined"==typeof Promise&&(!function(t){var e;"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Promise=t())}(function(){return function n(i,o,a){function s(r,t){if(!o[r]){if(!i[r]){var e="function"==typeof _dereq_&&_dereq_;if(!t&&e)return e(r,!0);if(u)return u(r,!0);t=new Error("Cannot find module '"+r+"'");throw t.code="MODULE_NOT_FOUND",t}e=o[r]={exports:{}};i[r][0].call(e.exports,function(t){var e=i[r][1][t];return s(e||t)},e,e.exports,n,i,o,a)}return o[r].exports}for(var u="function"==typeof _dereq_&&_dereq_,t=0;t<a.length;t++)s(a[t]);return s}({1:[function(t,e,r){"use strict";e.exports=function(t){function e(t){var t=new r(t),e=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),e}var r=t._SomePromiseArray;t.any=e,t.prototype.any=function(){return e(this)}}},{}],2:[function(t,e,r){"use strict";function n(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new c(16),this._normalQueue=new c(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=u}function i(t,e,r){this._lateQueue.push(t,e,r),this._queueTick()}function o(t,e,r){this._normalQueue.push(t,e,r),this._queueTick()}function a(t){this._normalQueue._pushOne(t),this._queueTick()}var s;try{throw new Error}catch(t){s=t}var u=t("./schedule"),c=t("./queue"),l=t("./util");n.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},n.prototype.hasCustomScheduler=function(){return this._customScheduler},n.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},n.prototype.disableTrampolineIfNecessary=function(){l.hasDevTools&&(this._trampolineEnabled=!1)},n.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},n.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},n.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},l.hasDevTools?(n.prototype.invokeLater=function(t,e,r){this._trampolineEnabled?i.call(this,t,e,r):this._schedule(function(){setTimeout(function(){t.call(e,r)},100)})},n.prototype.invoke=function(t,e,r){this._trampolineEnabled?o.call(this,t,e,r):this._schedule(function(){t.call(e,r)})},n.prototype.settlePromises=function(t){this._trampolineEnabled?a.call(this,t):this._schedule(function(){t._settlePromises()})}):(n.prototype.invokeLater=i,n.prototype.invoke=o,n.prototype.settlePromises=a),n.prototype._drainQueue=function(t){for(;0<t.length();){var e,r,n=t.shift();"function"==typeof n?(e=t.shift(),r=t.shift(),n.call(e,r)):n._settlePromises()}},n.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},n.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},n.prototype._reset=function(){this._isTickUsed=!1},e.exports=n,e.exports.firstLineError=s},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,r){"use strict";e.exports=function(i,o,a,s){function r(t,e){this._reject(e)}function u(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(r,r,null,this,t)}function c(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)}function l(t,e){e.promiseRejectionQueued||this._reject(t)}var f=!1;i.prototype.bind=function(t){f||(f=!0,i.prototype._propagateFrom=s.propagateFromFunction(),i.prototype._boundValue=s.boundValueFunction());var e,t=a(t),r=new i(o),n=(r._propagateFrom(this,1),this._target());return r._setBoundTo(t),t instanceof i?(n._then(o,u,void 0,r,e={promiseRejectionQueued:!1,promise:r,target:n,bindingPromise:t}),t._then(c,l,void 0,r,e),r._setOnCancel(t)):r._resolveCallback(n),r},i.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},i.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},i.bind=function(t,e){return i.resolve(e).bind(t)}}},{}],4:[function(t,e,r){"use strict";"undefined"!=typeof Promise&&(n=Promise);var n,i=t("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=n)}catch(t){}return i},e.exports=i},{"./promise":22}],5:[function(t,e,r){"use strict";var n,i=Object.create;i&&(n=i(null),i=i(null),n[" size"]=i[" size"]=0),e.exports=function(n){function r(t){return function(t,e){var r;if("function"!=typeof(r=null!=t?t[e]:r))throw t="Object "+a.classString(t)+" has no method '"+a.toString(e)+"'",new n.TypeError(t);return r}(t,this.pop()).apply(t,this)}function i(t){return t[this]}function o(t){var e=+this;return t[e=e<0?Math.max(0,e+t.length):e]}var a=t("./util"),s=a.canEvaluate;a.isIdentifier,n.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(r,void 0,void 0,e,void 0)},n.prototype.get=function(t){var e;return e="number"==typeof t?o:s&&null!==(e=(void 0)(t))?e:i,this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(u,t,e){"use strict";t.exports=function(t,e,r,n){var i=u("./util"),o=i.tryCatch,a=i.errorObj,s=t._async;t.prototype.break=t.prototype.cancel=function(){if(!n.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var r=t._cancellationParent;if(null==r||!r._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=r}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),s.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){0<this._length()&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(t,e){var r;if(i.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else void 0!==t&&("function"==typeof t?e||(r=o(t).call(this._boundValue()))===a&&(this._attachExtraTrace(r.e),s.throwLater(r.e)):t._resultCancelled(this))},t.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),s.invoke(this._doInvokeOnCancel,this,t)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,r){"use strict";e.exports=function(f){var h=t("./util"),p=t("./es5").keys,d=h.tryCatch,y=h.errorObj;return function(u,c,l){return function(t){var e=l._boundValue();t:for(var r=0;r<u.length;++r){var n=u[r];if(n===Error||null!=n&&n.prototype instanceof Error){if(t instanceof n)return d(c).call(e,t)}else if("function"==typeof n){var i=d(n).call(e,t);if(i===y)return i;if(i)return d(c).call(e,t)}else if(h.isObject(t)){for(var o=p(n),a=0;a<o.length;++a){var s=o[a];if(n[s]!=t[s])continue t}return d(c).call(e,t)}}return f}}}},{"./es5":13,"./util":36}],8:[function(t,e,r){"use strict";e.exports=function(o){function a(){this._trace=new a.CapturedTrace(s())}function s(){var t=r.length-1;return 0<=t?r[t]:void 0}var u=!1,r=[];return o.prototype._promiseCreated=function(){},o.prototype._pushContext=function(){},o.prototype._popContext=function(){return null},o._peekContext=o.prototype._peekContext=function(){},a.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},a.prototype._popContext=function(){var t,e;return void 0!==this._trace?(e=(t=r.pop())._promiseCreated,t._promiseCreated=null,e):null},a.CapturedTrace=null,a.create=function(){return u?new a:void 0},a.deactivateLongStackTraces=function(){},a.activateLongStackTraces=function(){var t=o.prototype._pushContext,e=o.prototype._popContext,r=o._peekContext,n=o.prototype._peekContext,i=o.prototype._promiseCreated;a.deactivateLongStackTraces=function(){o.prototype._pushContext=t,o.prototype._popContext=e,o._peekContext=r,o.prototype._peekContext=n,o.prototype._promiseCreated=i,u=!1},u=!0,o.prototype._pushContext=a.prototype._pushContext,o.prototype._popContext=a.prototype._popContext,o._peekContext=o.prototype._peekContext=s,o.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},a}},{}],9:[function(G,t,e){"use strict";t.exports=function(n,r){function t(t,e){return{promise:e}}function i(){return!1}function o(t,e,r){var n=this;try{t(e,r,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+b.toString(t));n._attachCancellationCallback(t)})}catch(t){return t}}function O(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?b.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function D(){return this._onCancelField}function K(t){this._onCancelField=t}function L(){this._cancellationParent=void 0,this._onCancelField=void 0}function a(t,e){var r;0!=(1&e)&&(r=(this._cancellationParent=t)._branchesRemainingToCancel,t._branchesRemainingToCancel=(r=void 0===r?0:r)+1),0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function H(){var t=this._boundTo;return void 0!==t&&t instanceof n?t.isFulfilled()?t.value():void 0:t}function M(){this._trace=new h(this._peekContext())}function V(t,e){var r;W(t)&&(void 0!==(r=void 0!==(r=this._trace)&&e?r._parent:r)?r.attachExtraTrace(t):t.__stackCleaned__||(e=g(t),b.notEnumerableProp(t,"stack",e.message+"\n"+e.stack.join("\n")),b.notEnumerableProp(t,"__stackCleaned__",!0)))}function s(t,e,r){I.warnings&&(t=new N(t),e?r._attachExtraTrace(t):I.longStackTraces&&(e=n._peekContext())?e.attachExtraTrace(t):(r=g(t),t.stack=r.message+"\n"+r.stack.join("\n")),F("warning",t)||u(t,"",!0))}function _(t){for(var e=[],r=0;r<t.length;++r){var n=t[r],i="    (No stack trace)"===n||C.test(n),o=i&&T(n);i&&!o&&(S&&" "!==n.charAt(0)&&(n="    "+n),e.push(n))}return e}function g(t){var e=t.stack,r=t.toString(),e="string"==typeof e&&0<e.length?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),r=0;r<e.length;++r){var n=e[r];if("    (No stack trace)"===n||C.test(n))break}return e=0<r&&"SyntaxError"!=t.name?e.slice(r):e}(t):["    (No stack trace)"];return{message:r,stack:"SyntaxError"==t.name?e:_(e)}}function u(t,e,r){var n;"undefined"!=typeof console&&(n=b.isObject(t)?(n=t.stack,e+A(n,t)):e+String(t),"function"==typeof y?y(n,r):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n))}function e(t,e,r,n){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(n):e(r,n))}catch(t){m.throwLater(t)}"unhandledRejection"===t?F(t,r,n)||i||u(r,"Unhandled rejection "):F(t,n)}function c(t){if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():b.toString(t);if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{var e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+((t=e).length<41?t:t.substr(0,38)+"...")+">, no stack trace)"}function l(){return"function"==typeof R}function f(t){t=t.match(z);return t?{fileName:t[1],line:parseInt(t[2],10)}:void 0}function h(t){this._parent=t,this._promisesCreated=0;t=this._length=1+(void 0===t?0:t._length);R(this,h),32<t&&this.uncycle()}var p,d,y,v=n._getDomain,m=n._async,N=G("./errors").Warning,b=G("./util"),W=b.canAttachTrace,w=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,q=/\((?:timers\.js):\d+:\d+\)/,Q=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,C=null,A=null,S=!1,k=!(0==b.env("BLUEBIRD_DEBUG")||!b.env("BLUEBIRD_DEBUG")&&"development"!==b.env("NODE_ENV")),B=!(0==b.env("BLUEBIRD_WARNINGS")||!k&&!b.env("BLUEBIRD_WARNINGS")),k=!(0==b.env("BLUEBIRD_LONG_STACK_TRACES")||!k&&!b.env("BLUEBIRD_LONG_STACK_TRACES")),E=0!=b.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(B||!!b.env("BLUEBIRD_W_FORGOTTEN_RETURN")),j=(n.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},n.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),m.invokeLater(this._notifyUnhandledRejection,this,void 0))},n.prototype._notifyUnhandledRejectionIsHandled=function(){e("rejectionHandled",p,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},n.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){var t;this._isRejectionUnhandled()&&(t=this._settledValue(),this._setUnhandledRejectionIsNotified(),e("unhandledRejection",d,t,this))},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},n.prototype._isUnhandledRejectionNotified=function(){return 0<(262144&this._bitField)},n.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return 0<(1048576&this._bitField)},n.prototype._warn=function(t,e,r){return s(t,e,r||this)},n.onPossiblyUnhandledRejection=function(t){var e=v();d="function"==typeof t?null===e?t:b.domainBind(e,t):void 0},n.onUnhandledRejectionHandled=function(t){var e=v();p="function"==typeof t?null===e?t:b.domainBind(e,t):void 0},function(){}),P=(n.longStackTraces=function(){if(m.haveItemsQueued()&&!I.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");var t,e;!I.longStackTraces&&l()&&(t=n.prototype._captureStackTrace,e=n.prototype._attachExtraTrace,I.longStackTraces=!0,j=function(){if(m.haveItemsQueued()&&!I.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=t,n.prototype._attachExtraTrace=e,r.deactivateLongStackTraces(),m.enableTrampoline(),I.longStackTraces=!1},n.prototype._captureStackTrace=M,n.prototype._attachExtraTrace=V,r.activateLongStackTraces(),m.disableTrampolineIfNecessary())},n.hasLongStackTraces=function(){return I.longStackTraces&&l()},function(){try{var t;return"function"==typeof CustomEvent?(t=new CustomEvent("CustomEvent"),b.global.dispatchEvent(t),function(t,e){t=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!b.global.dispatchEvent(t)}):"function"==typeof Event?(t=new Event("CustomEvent"),b.global.dispatchEvent(t),function(t,e){t=new Event(t.toLowerCase(),{cancelable:!0});return t.detail=e,!b.global.dispatchEvent(t)}):((t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),b.global.dispatchEvent(t),function(t,e){var r=document.createEvent("CustomEvent");return r.initCustomEvent(t.toLowerCase(),!1,!0,e),!b.global.dispatchEvent(r)})}catch(t){}return function(){return!1}}()),x=b.isNode?function(){return process.emit.apply(process,arguments)}:b.global?function(t){t="on"+t.toLowerCase(),t=b.global[t];return!!t&&(t.apply(b.global,[].slice.call(arguments,1)),!0)}:function(){return!1},J={promiseCreated:t,promiseFulfilled:t,promiseRejected:t,promiseResolved:t,promiseCancelled:t,promiseChained:function(t,e,r){return{promise:e,child:r}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,r){return{reason:e,promise:r}},rejectionHandled:t},F=function(t){var e=!1;try{e=x.apply(null,arguments)}catch(t){m.throwLater(t),e=!0}var r=!1;try{r=P(t,J[t].apply(null,arguments))}catch(t){m.throwLater(t),r=!0}return r||e},U=(n.config=function(t){var e;if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?n.longStackTraces():!t.longStackTraces&&n.hasLongStackTraces()&&j()),"warnings"in t&&(e=t.warnings,I.warnings=!!e,E=I.warnings,b.isObject(e)&&"wForgottenReturn"in e&&(E=!!e.wForgottenReturn)),"cancellation"in t&&t.cancellation&&!I.cancellation){if(m.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=L,n.prototype._propagateFrom=a,n.prototype._onCancel=D,n.prototype._setOnCancel=K,n.prototype._attachCancellationCallback=O,n.prototype._execute=o,U=a,I.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!I.monitoring?(I.monitoring=!0,n.prototype._fireEvent=F):!t.monitoring&&I.monitoring&&(I.monitoring=!1,n.prototype._fireEvent=i)),n},n.prototype._fireEvent=i,n.prototype._execute=function(t,e,r){try{t(e,r)}catch(t){return t}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(t){},n.prototype._attachCancellationCallback=function(t){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(t,e){},function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}),T=function(){return!1},z=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/,R=(b.inherits(h,Error),(r.CapturedTrace=h).prototype.uncycle=function(){if(!(this._length<2)){for(var t=[],e={},r=0,n=this;void 0!==n;++r)t.push(n),n=n._parent;for(var i,r=(i=this._length=r)-1;0<=r;--r){var o=t[r].stack;void 0===e[o]&&(e[o]=r)}for(r=0;r<i;++r){var a=e[t[r].stack];if(void 0!==a&&a!==r){0<a&&(t[a-1]._parent=void 0,t[a-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var s=0<r?t[r-1]:this;a<i-1?(s._parent=t[a+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var u=s._length+1,c=r-2;0<=c;--c)t[c]._length=u,u++;return}}}},h.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=g(t),r=e.message,n=[e.stack],i=this;void 0!==i;)n.push(_(i.stack.split("\n"))),i=i._parent;for(var o=n,a=o[0],s=1;s<o.length;++s){for(var u=o[s],c=a.length-1,l=a[c],f=-1,h=u.length-1;0<=h;--h)if(u[h]===l){f=h;break}for(h=f;0<=h;--h){var p=u[h];if(a[c]!==p)break;a.pop(),c--}a=u}for(var d=n,y=0;y<d.length;++y)(0===d[y].length||y+1<d.length&&d[y][0]===d[y+1][0])&&(d.splice(y,1),y--);b.notEnumerableProp(t,"stack",function(t,e){for(var r=0;r<e.length-1;++r)e[r].push("From previous event:"),e[r]=e[r].join("\n");return r<e.length&&(e[r]=e[r].join("\n")),t+"\n"+e.join("\n")}(r,n)),b.notEnumerableProp(t,"__stackCleaned__",!0)}},function(){function t(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():c(e)}var r,e=/^\s*at\s*/;if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace)return Error.stackTraceLimit+=6,C=e,A=t,r=Error.captureStackTrace,T=function(t){return w.test(t)},function(t,e){Error.stackTraceLimit+=6,r(t,e),Error.stackTraceLimit-=6};var n,i=new Error;if("string"==typeof i.stack&&0<=i.stack.split("\n")[0].indexOf("stackDetection@"))return C=/@/,A=t,S=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){n="stack"in t}return"stack"in i||!n||"number"!=typeof Error.stackTraceLimit?(A=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?c(e):e.toString()},null):(C=e,A=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}()),I=("undefined"!=typeof console&&void 0!==console.warn&&(y=function(t){console.warn(t)},b.isNode&&process.stderr.isTTY?y=function(t,e){console.warn((e?"[33m":"[31m")+t+"[0m\n")}:b.isNode||"string"!=typeof(new Error).stack||(y=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")})),{warnings:B,longStackTraces:!1,cancellation:!1,monitoring:!1});return k&&n.longStackTraces(),{longStackTraces:function(){return I.longStackTraces},warnings:function(){return I.warnings},cancellation:function(){return I.cancellation},monitoring:function(){return I.monitoring},propagateFromFunction:function(){return U},boundValueFunction:function(){return H},checkForgottenReturns:function(t,e,r,n,i){if(void 0===t&&null!==e&&E&&(void 0===i||!i._returnedNonUndefined())&&0!=(65535&n._bitField)){r&&(r+=" ");var o="",a="";if(e._trace){for(var s=e._trace.stack.split("\n"),u=_(s),c=u.length-1;0<=c;--c){var l=u[c];if(!q.test(l)){l=l.match(Q);l&&(o="at "+l[1]+":"+l[2]+":"+l[3]+" ");break}}if(0<u.length)for(var f=u[0],c=0;c<s.length;++c)if(s[c]===f){0<c&&(a="\n"+s[c-1]);break}}n._warn("a promise was created in a "+r+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+a,!0,e)}},setBounds:function(t,e){if(l()){for(var r,n,i=t.stack.split("\n"),o=e.stack.split("\n"),a=-1,s=-1,u=0;u<i.length;++u)if(c=f(i[u])){r=c.fileName,a=c.line;break}for(var c,u=0;u<o.length;++u)if(c=f(o[u])){n=c.fileName,s=c.line;break}a<0||s<0||!r||!n||r!==n||s<=a||(T=function(t){return!!w.test(t)||!!((t=f(t))&&t.fileName===r&&a<=t.line&&t.line<=s)})}},warn:s,deprecated:function(t,e){return t+=" is deprecated and will be removed in a future version.",e&&(t+=" Use "+e+" instead."),s(t)},CapturedTrace:h,fireDomEvent:P,fireGlobalEvent:x}}},{"./errors":12,"./util":36}],10:[function(t,e,r){"use strict";e.exports=function(r){function n(){return this.value}function i(){throw this.reason}r.prototype.return=r.prototype.thenReturn=function(t){return t instanceof r&&t.suppressUnhandledRejections(),this._then(n,void 0,void 0,{value:t},void 0)},r.prototype.throw=r.prototype.thenThrow=function(t){return this._then(i,void 0,void 0,{reason:t},void 0)},r.prototype.catchThrow=function(t){var e;return arguments.length<=1?this._then(void 0,i,void 0,{reason:t},void 0):(e=arguments[1],this.caught(t,function(){throw e}))},r.prototype.catchReturn=function(t){var e;return arguments.length<=1?(t instanceof r&&t.suppressUnhandledRejections(),this._then(void 0,n,void 0,{value:t},void 0)):((e=arguments[1])instanceof r&&e.suppressUnhandledRejections(),this.caught(t,function(){return e}))}}},{}],11:[function(t,e,r){"use strict";e.exports=function(t,r){function n(){return e(this)}var i=t.reduce,e=t.all;t.prototype.each=function(t){return i(this,t,r,0)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return i(this,t,r,r)},t.each=function(t,e){return i(t,e,r,0)._then(n,void 0,void 0,t,void 0)},t.mapSeries=function(t,e){return i(t,e,r,r)}}},{}],12:[function(t,e,r){"use strict";function n(e,r){function n(t){return this instanceof n?(l(this,"message","string"==typeof t?t:r),l(this,"name",e),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(t)}return c(n,Error),n}function i(t){return this instanceof i?(l(this,"name","OperationalError"),l(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(l(this,"message",t.message),l(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(t)}var o,a,s=t("./es5"),u=s.freeze,t=t("./util"),c=t.inherits,l=t.notEnumerableProp,t=n("Warning","warning"),f=n("CancellationError","cancellation error"),h=n("TimeoutError","timeout error"),p=n("AggregateError","aggregate error");try{o=TypeError,a=RangeError}catch(t){o=n("TypeError","type error"),a=n("RangeError","range error")}for(var d="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<d.length;++y)"function"==typeof Array.prototype[d[y]]&&(p.prototype[d[y]]=Array.prototype[d[y]]);s.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var _=0,g=(p.prototype.toString=function(){var t="\n"+Array(4*_+1).join(" ")+"AggregateError of:\n";_++;for(var e=Array(4*_+1).join(" "),r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",i=n.split("\n"),o=0;o<i.length;++o)i[o]=e+i[o];t+=(n=i.join("\n"))+"\n"}return _--,t},c(i,Error),Error.__BluebirdErrorTypes__);g||(g=u({CancellationError:f,TimeoutError:h,OperationalError:i,RejectionError:i,AggregateError:p}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:g,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:o,RangeError:a,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:t}},{"./es5":13,"./util":36}],13:[function(t,e,r){var n,i,o,a=function(){"use strict";return void 0===this}();a?e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:a,propertyIsWritable:function(t,e){t=Object.getOwnPropertyDescriptor(t,e);return!(t&&!t.writable&&!t.set)}}:(n={}.hasOwnProperty,i={}.toString,o={}.constructor.prototype,e.exports={isArray:function(t){try{return"[object Array]"===i.call(t)}catch(t){return!1}},keys:e=function(t){var e,r=[];for(e in t)n.call(t,e)&&r.push(e);return r},names:e,defineProperty:function(t,e,r){return t[e]=r.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return o}},isES5:a,propertyIsWritable:function(){return!0}})},{}],14:[function(t,e,r){"use strict";e.exports=function(t,n){var i=t.map;t.prototype.filter=function(t,e){return i(this,t,e,n)},t.filter=function(t,e,r){return i(t,e,r,n)}}},{}],15:[function(t,e,r){"use strict";e.exports=function(a,i,o){function s(t,e,r){this.promise=t,this.type=e,this.handler=r,this.called=!1,this.cancelPromise=null}function u(t){this.finallyHandler=t}function c(t,e){return null!=t.cancelPromise&&(1<arguments.length?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,1)}function l(){return h.call(this,this.promise._target()._settledValue())}function f(t){return c(this,t)?void 0:(y.e=t,y)}function h(t){var e=this.promise,r=this.handler;if(!this.called){this.called=!0;r=this.isFinallyHandler()?r.call(e._boundValue()):r.call(e._boundValue(),t);if(r===o)return r;if(void 0!==r){e._setReturnedNonUndefined();var n,r=i(r,e);if(r instanceof a){if(null!=this.cancelPromise){if(r._isCancelled())return n=new d("late cancellation observer"),e._attachExtraTrace(n),y.e=n,y;r.isPending()&&r._attachCancellationCallback(new u(this))}return r._then(l,f,void 0,this,void 0)}}}return e.isRejected()?(c(this),y.e=t,y):(c(this),t)}var p=t("./util"),d=a.CancellationError,y=p.errorObj,_=t("./catch_filter")(o);return s.prototype.isFinallyHandler=function(){return 0===this.type},u.prototype._resultCancelled=function(){c(this.finallyHandler)},a.prototype._passThrough=function(t,e,r,n){return"function"!=typeof t?this.then():this._then(r,n,void 0,new s(this,e,t),void 0)},a.prototype.lastly=a.prototype.finally=function(t){return this._passThrough(t,0,h,h)},a.prototype.tap=function(t){return this._passThrough(t,1,h)},a.prototype.tapCatch=function(t){var e=arguments.length;if(1===e)return this._passThrough(t,1,void 0,h);for(var r=new Array(e-1),n=0,i=0;i<e-1;++i){var o=arguments[i];if(!p.isObject(o))return a.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+p.classString(o)));r[n++]=o}return r.length=n,this._passThrough(_(r,arguments[i],this),1,void 0,h)},s}},{"./catch_filter":7,"./util":36}],16:[function(n,t,e){"use strict";t.exports=function(a,r,s,u,t,c){function l(t,e,r,n){var i,o;c.cancellation()?(i=new a(s),o=this._finallyPromise=new a(s),this._promise=i.lastly(function(){return o}),i._captureStackTrace(),i._setOnCancel(this)):(this._promise=new a(s))._captureStackTrace(),this._stack=n,this._generatorFunction=t,this._receiver=e,this._generator=void 0,this._yieldHandlers="function"==typeof r?[r].concat(d):d,this._yieldedPromise=null,this._cancellationPhase=!1}var f=n("./errors").TypeError,e=n("./util"),h=e.errorObj,p=e.tryCatch,d=[];e.inherits(l,t),l.prototype._isResolved=function(){return null===this._promise},l.prototype._cleanup=function(){this._promise=this._generator=null,c.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},l.prototype._promiseCancelled=function(){var t;this._isResolved()||(t=void 0!==this._generator.return?(this._promise._pushContext(),p(this._generator.return).call(this._generator,void 0)):(t=new a.CancellationError("generator .return() sentinel"),a.coroutine.returnSentinel=t,this._promise._attachExtraTrace(t),this._promise._pushContext(),p(this._generator.throw).call(this._generator,t)),this._promise._popContext(),this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t))},l.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();t=p(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(t)},l.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();t=p(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(t)},l.prototype._resultCancelled=function(){var t;this._yieldedPromise instanceof a&&(t=this._yieldedPromise,this._yieldedPromise=null,t.cancel())},l.prototype.promise=function(){return this._promise},l.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},l.prototype._continue=function(t){var e,r=this._promise;return t===h?(this._cleanup(),this._cancellationPhase?r.cancel():r._rejectCallback(t.e,!1)):(e=t.value,!0===t.done?(this._cleanup(),this._cancellationPhase?r.cancel():r._resolveCallback(e)):void((t=u(e,this._promise))instanceof a||null!==(t=function(t,e,r){for(var n=0;n<e.length;++n){r._pushContext();var i=p(e[n])(t);if(r._popContext(),i===h)return r._pushContext(),o=a.reject(h.e),r._popContext(),o;var o=u(i,r);if(o instanceof a)return o}return null}(t,this._yieldHandlers,this._promise))?0==(50397184&(r=(t=t._target())._bitField))?(this._yieldedPromise=t)._proxy(this,null):0!=(33554432&r)?a._async.invoke(this._promiseFulfilled,this,t._value()):0!=(16777216&r)?a._async.invoke(this._promiseRejected,this,t._reason()):this._promiseCancelled():this._promiseRejected(new f("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(e))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))))},a.coroutine=function(n,t){if("function"!=typeof n)throw new f("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=Object(t).yieldHandler,o=l,a=(new Error).stack;return function(){var t=n.apply(this,arguments),e=new o(void 0,void 0,i,a),r=e.promise();return e._generator=t,e._promiseFulfilled(void 0),r}},a.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new f("expecting a function but got "+e.classString(t));d.push(t)},a.spawn=function(t){var e;return c.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t?r("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n"):(e=(t=new l(t,this)).promise(),t._run(a.spawn),e)}}},{"./errors":12,"./util":36}],17:[function(s,t,e){"use strict";t.exports=function(t,r,e,n,i,o){var a=s("./util");a.canEvaluate,a.tryCatch,a.errorObj,t.join=function(){var t,e=arguments.length-1,e=(0<e&&"function"==typeof arguments[e]&&(t=arguments[e]),[].slice.call(arguments)),e=(t&&e.pop(),new r(e).promise());return void 0!==t?e.spread(t):e}}},{"./util":36}],18:[function(e,t,r){"use strict";t.exports=function(c,t,o,l,i,f){function a(t,e,r,n){this.constructor$(t),this._promise._captureStackTrace();t=s();this._callback=null===t?e:u.domainBind(t,e),this._preservedValues=n===i?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],d.invoke(this._asyncInit,this,void 0)}function r(t,e,r,n){if("function"!=typeof e)return o("expecting a function but got "+u.classString(e));var i=0;if(void 0!==r){if("object"!=typeof r||null===r)return c.reject(new TypeError("options argument must be an object but it is "+u.classString(r)));if("number"!=typeof r.concurrency)return c.reject(new TypeError("'concurrency' must be a number but it is "+u.classString(r.concurrency)));i=r.concurrency}return new a(t,e,i="number"==typeof i&&isFinite(i)&&1<=i?i:0,n).promise()}var s=c._getDomain,u=e("./util"),h=u.tryCatch,p=u.errorObj,d=c._async;u.inherits(a,t),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(t,e){var r=this._values,n=this.length(),i=this._preservedValues,o=this._limit;if(e<0){if(r[e=-1*e-1]=t,1<=o&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(1<=o&&this._inFlight>=o)return r[e]=t,this._queue.push(e),!1;null!==i&&(i[e]=t);var a=this._promise,s=this._callback,u=a._boundValue(),s=(a._pushContext(),h(s).call(u,t,e,n)),u=a._popContext();if(f.checkForgottenReturns(s,u,null!==i?"Promise.filter":"Promise.map",a),s===p)return this._reject(s.e),!0;if((t=l(s,this._promise))instanceof c){u=(t=t._target())._bitField;if(0==(50397184&u))return 1<=o&&this._inFlight++,(r[e]=t)._proxy(this,-1*(e+1)),!1;if(0==(33554432&u))return 0!=(16777216&u)?this._reject(t._reason()):this._cancel(),!0;s=t._value()}r[e]=s}return n<=++this._totalResolved&&(null!==i?this._filter(r,i):this._resolve(r),!0)},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,r=this._values;0<t.length&&this._inFlight<e;){if(this._isResolved())return;var n=t.pop();this._promiseFulfilled(r[n],n)}},a.prototype._filter=function(t,e){for(var r=e.length,n=new Array(r),i=0,o=0;o<r;++o)t[o]&&(n[i++]=e[o]);n.length=i,this._resolve(n)},a.prototype.preservedValues=function(){return this._preservedValues},c.prototype.map=function(t,e){return r(this,t,e,null)},c.map=r}},{"./util":36}],19:[function(e,t,r){"use strict";t.exports=function(i,o,t,a,s){var u=e("./util"),c=u.tryCatch;i.method=function(n){if("function"!=typeof n)throw new i.TypeError("expecting a function but got "+u.classString(n));return function(){var t=new i(o),e=(t._captureStackTrace(),t._pushContext(),c(n).apply(this,arguments)),r=t._popContext();return s.checkForgottenReturns(e,r,"Promise.method",t),t._resolveFromSyncValue(e),t}},i.attempt=i.try=function(t){var e,r,n;return"function"!=typeof t?a("expecting a function but got "+u.classString(t)):((e=new i(o))._captureStackTrace(),e._pushContext(),r=1<arguments.length?(s.deprecated("calling Promise.try with more than 1 argument"),n=arguments[1],r=arguments[2],u.isArray(n)?c(t).apply(r,n):c(t).call(r,n)):c(t)(),n=e._popContext(),s.checkForgottenReturns(r,n,"Promise.try",e),e._resolveFromSyncValue(r),e)},i.prototype._resolveFromSyncValue=function(t){t===u.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,r){"use strict";function i(t){var e,r;if((r=t)instanceof Error&&u.getPrototypeOf(r)===Error.prototype){(e=new s(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=u.keys(t),i=0;i<n.length;++i){var o=n[i];c.test(o)||(e[o]=t[o])}return e}return a.markAsOriginatingFromRejection(t),t}var a=t("./util"),o=a.maybeWrapAsError,s=t("./errors").OperationalError,u=t("./es5"),c=/^(?:name|message|stack|cause)$/;e.exports=function(r,n){return function(t,e){null!==r&&(t?(t=i(o(t)),r._attachExtraTrace(t),r._reject(t)):n?(t=[].slice.call(arguments,1),r._fulfill(t)):r._fulfill(e),r=null)}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,r){"use strict";t.exports=function(t){function n(t,e){if(!r.isArray(t))return i.call(this,t,e);e=s(e).apply(this._boundValue(),[null].concat(t));e===u&&a.throwLater(e.e)}function i(t,e){var r=this._boundValue(),e=void 0===t?s(e).call(r,null):s(e).call(r,null,t);e===u&&a.throwLater(e.e)}function o(t,e){t||((r=new Error(t+"")).cause=t,t=r);var r=s(e).call(this._boundValue(),t);r===u&&a.throwLater(r.e)}var r=e("./util"),a=t._async,s=r.tryCatch,u=r.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(t,e){var r;return"function"==typeof t&&(r=i,void 0!==e&&Object(e).spread&&(r=n),this._then(r,o,void 0,this,t)),this}}},{"./util":36}],22:[function(j,P,t){"use strict";P.exports=function(){function s(){}function f(t){if(t!==_){var e=this,r=t;if(null==e||e.constructor!==f)throw new l("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof r)throw new l("expecting a function but got "+h.classString(r))}this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function t(t){this.promise._resolveCallback(t)}function e(t){this.promise._rejectCallback(t,!1)}function r(t){var e=new f(_);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}function a(){return new l("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")}function u(){return new f.PromiseInspection(this._target())}function c(t){return f.reject(new l(t))}var o={},h=j("./util"),p=h.isNode?function(){var t=process.domain;return t=void 0===t?null:t}:function(){return null},n=(h.notEnumerableProp(f,"_getDomain",p),j("./es5")),i=j("./async"),d=new i,n=(n.defineProperty(f,"_async",{value:d}),j("./errors")),l=f.TypeError=n.TypeError,y=(f.RangeError=n.RangeError,f.CancellationError=n.CancellationError),_=(f.TimeoutError=n.TimeoutError,f.OperationalError=n.OperationalError,f.RejectionError=n.OperationalError,f.AggregateError=n.AggregateError,function(){}),g={},v={},m=j("./thenables")(f,_),b=j("./promise_array")(f,_,m,c,s),n=j("./context")(f),w=n.create,C=j("./debuggability")(f,n),A=(C.CapturedTrace,j("./finally")(f,m,v)),S=j("./catch_filter")(v),k=j("./nodeback"),B=h.errorObj,E=h.tryCatch;return f.prototype.toString=function(){return"[object Promise]"},f.prototype.caught=f.prototype.catch=function(t){var e=arguments.length;if(1<e){for(var r=new Array(e-1),n=0,i=0;i<e-1;++i){var o=arguments[i];if(!h.isObject(o))return c("Catch statement predicate: expecting an object but got "+h.classString(o));r[n++]=o}return r.length=n,this.then(void 0,S(r,t=arguments[i],this))}return this.then(void 0,t)},f.prototype.reflect=function(){return this._then(u,u,void 0,this,void 0)},f.prototype.then=function(t,e){var r;return C.warnings()&&0<arguments.length&&"function"!=typeof t&&"function"!=typeof e&&(r=".then() only accepts functions but was passed: "+h.classString(t),1<arguments.length&&(r+=", "+h.classString(e)),this._warn(r)),this._then(t,e,void 0,void 0,void 0)},f.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},f.prototype.spread=function(t){return"function"!=typeof t?c("expecting a function but got "+h.classString(t)):this.all()._then(t,void 0,void 0,g,void 0)},f.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},f.prototype.all=function(){return 0<arguments.length&&this._warn(".all() was passed arguments but it does not take any"),new b(this).promise()},f.prototype.error=function(t){return this.caught(h.originatesFromRejection,t)},f.getNewLibraryCopy=P.exports,f.is=function(t){return t instanceof f},f.fromNode=f.fromCallback=function(t){var e=new f(_),r=(e._captureStackTrace(),1<arguments.length&&!!Object(arguments[1]).multiArgs),t=E(t)(k(e,r));return t===B&&e._rejectCallback(t.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},f.all=function(t){return new b(t).promise()},f.resolve=f.fulfilled=f.cast=function(t){var e=m(t);return e instanceof f||((e=new f(_))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},f.reject=f.rejected=function(t){var e=new f(_);return e._captureStackTrace(),e._rejectCallback(t,!0),e},f.setScheduler=function(t){if("function"!=typeof t)throw new l("expecting a function but got "+h.classString(t));return d.setScheduler(t)},f.prototype._then=function(t,e,r,n,i){var o,a,s,u=void 0!==i,i=u?i:new f(_),c=this._target(),l=c._bitField,u=(u||(i._propagateFrom(this,3),i._captureStackTrace(),void 0===n&&0!=(2097152&this._bitField)&&(n=0!=(50397184&l)?this._boundValue():c===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,i)),p());return 0!=(50397184&l)?(s=c._settlePromiseCtx,0!=(33554432&l)?(a=c._rejectionHandler0,o=t):0!=(16777216&l)?(a=c._fulfillmentHandler0,o=e,c._unsetRejectionIsUnhandled()):(s=c._settlePromiseLateCancellationObserver,a=new y("late cancellation observer"),c._attachExtraTrace(a),o=e),d.invoke(s,c,{handler:null===u?o:"function"==typeof o&&h.domainBind(u,o),promise:i,receiver:n,value:a})):c._addCallbacks(t,e,i,n,u),i},f.prototype._length=function(){return 65535&this._bitField},f.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},f.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},f.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},f.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},f.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},f.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},f.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},f.prototype._isFinal=function(){return 0<(4194304&this._bitField)},f.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},f.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},f.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},f.prototype._setAsyncGuaranteed=function(){d.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},f.prototype._receiverAt=function(t){t=0===t?this._receiver0:this[4*t-4+3];return t===o?void 0:void 0===t&&this._isBound()?this._boundValue():t},f.prototype._promiseAt=function(t){return this[4*t-4+2]},f.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4]},f.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},f.prototype._boundValue=function(){},f.prototype._migrateCallback0=function(t){t._bitField;var e=t._fulfillmentHandler0,r=t._rejectionHandler0,n=t._promise0,t=t._receiverAt(0);this._addCallbacks(e,r,n,t=void 0===t?o:t,null)},f.prototype._migrateCallbackAt=function(t,e){var r=t._fulfillmentHandlerAt(e),n=t._rejectionHandlerAt(e),i=t._promiseAt(e),t=t._receiverAt(e);this._addCallbacks(r,n,i,t=void 0===t?o:t,null)},f.prototype._addCallbacks=function(t,e,r,n,i){var o,a=this._length();return 65531<=a&&this._setLength(a=0),0===a?(this._promise0=r,this._receiver0=n,"function"==typeof t&&(this._fulfillmentHandler0=null===i?t:h.domainBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:h.domainBind(i,e))):(this[2+(o=4*a-4)]=r,this[3+o]=n,"function"==typeof t&&(this[o]=null===i?t:h.domainBind(i,t)),"function"==typeof e&&(this[1+o]=null===i?e:h.domainBind(i,e))),this._setLength(a+1),a},f.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},f.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(a(),!1);var r=m(t,this);if(!(r instanceof f))return this._fulfill(t);e&&this._propagateFrom(r,2);var n=r._target();if(n===this)this._reject(a());else{t=n._bitField;if(0==(50397184&t)){var i=this._length();0<i&&n._migrateCallback0(this);for(var o=1;o<i;++o)n._migrateCallbackAt(this,o);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else 0!=(33554432&t)?this._fulfill(n._value()):0!=(16777216&t)?this._reject(n._reason()):(e=new y("late cancellation observer"),n._attachExtraTrace(e),this._reject(e))}}},f.prototype._rejectCallback=function(t,e,r){var n=h.ensureErrorObject(t),i=n===t;i||r||!C.warnings()||(r="a promise was rejected with a non-error: "+h.classString(t),this._warn(r,!0)),this._attachExtraTrace(n,!!e&&i),this._reject(t)},f.prototype._resolveFromExecutor=function(t){var e,r;t!==_&&((e=this)._captureStackTrace(),this._pushContext(),r=!0,t=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,r)}),r=!1,this._popContext(),void 0!==t&&e._rejectCallback(t,!0))},f.prototype._settlePromiseFromHandler=function(t,e,r,n){var i;0==(65536&n._bitField)&&(n._pushContext(),e===g?r&&"number"==typeof r.length?i=E(t).apply(this._boundValue(),r):(i=B).e=new l("cannot .spread() a non-array: "+h.classString(r)):i=E(t).call(e,r),t=n._popContext(),0==(65536&n._bitField)&&(i===v?n._reject(r):i===B?n._rejectCallback(i.e,!1):(C.checkForgottenReturns(i,t,"",n,this),n._resolveCallback(i))))},f.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},f.prototype._followee=function(){return this._rejectionHandler0},f.prototype._setFollowee=function(t){this._rejectionHandler0=t},f.prototype._settlePromise=function(t,e,r,n){var i=t instanceof f,o=this._bitField,a=0!=(134217728&o);0!=(65536&o)?(i&&t._invokeInternalOnCancel(),r instanceof A&&r.isFinallyHandler()?(r.cancelPromise=t,E(e).call(r,n)===B&&t._reject(B.e)):e===u?t._fulfill(u.call(r)):r instanceof s?r._promiseCancelled(t):i||t instanceof b?t._cancel():r.cancel()):"function"==typeof e?i?(a&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,r,n,t)):e.call(r,n,t):r instanceof s?r._isResolved()||(0!=(33554432&o)?r._promiseFulfilled(n,t):r._promiseRejected(n,t)):i&&(a&&t._setAsyncGuaranteed(),0!=(33554432&o)?t._fulfill(n):t._reject(n))},f.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,r=t.promise,n=t.receiver,t=t.value;"function"==typeof e?r instanceof f?this._settlePromiseFromHandler(e,n,t,r):e.call(n,t,r):r instanceof f&&r._reject(t)},f.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},f.prototype._settlePromise0=function(t,e,r){var n=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,t,i,e)},f.prototype._clearCallbackDataAtIndex=function(t){t=4*t-4;this[2+t]=this[3+t]=this[t]=this[1+t]=void 0},f.prototype._fulfill=function(t){var e,r=this._bitField;if(!((117506048&r)>>>16)){if(t===this)return e=a(),this._attachExtraTrace(e),this._reject(e);this._setFulfilled(),this._rejectionHandler0=t,0<(65535&r)&&(0!=(134217728&r)?this._settlePromises():d.settlePromises(this))}},f.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?d.fatalError(t,h.isNode):void(0<(65535&e)?d.settlePromises(this):this._ensurePossibleRejectionHandled())},f.prototype._fulfillPromises=function(t,e){for(var r=1;r<t;r++){var n=this._fulfillmentHandlerAt(r),i=this._promiseAt(r),o=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,o,e)}},f.prototype._rejectPromises=function(t,e){for(var r=1;r<t;r++){var n=this._rejectionHandlerAt(r),i=this._promiseAt(r),o=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,o,e)}},f.prototype._settlePromises=function(){var t,e=this._bitField,r=65535&e;0<r&&(0!=(16842752&e)?(t=this._fulfillmentHandler0,this._settlePromise0(this._rejectionHandler0,t,e),this._rejectPromises(r,t)):(t=this._rejectionHandler0,this._settlePromise0(this._fulfillmentHandler0,t,e),this._fulfillPromises(r,t)),this._setLength(0)),this._clearCancellationData()},f.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},f.defer=f.pending=function(){return C.deprecated("Promise.defer","new Promise"),{promise:new f(_),resolve:t,reject:e}},h.notEnumerableProp(f,"_makeSelfResolutionError",a),j("./method")(f,_,m,c,C),j("./bind")(f,_,m,C),j("./cancel")(f,b,c,C),j("./direct_resolve")(f),j("./synchronous_inspection")(f),j("./join")(f,b,m,_,d,p),(f.Promise=f).version="3.5.0",j("./map.js")(f,b,c,m,_,C),j("./call_get.js")(f),j("./using.js")(f,c,m,w,_,C),j("./timers.js")(f,_,C),j("./generators.js")(f,c,_,m,s,C),j("./nodeify.js")(f),j("./promisify.js")(f,_),j("./props.js")(f,b,m,c),j("./race.js")(f,_,m,c),j("./reduce.js")(f,b,c,m,_,C),j("./settle.js")(f,b,C),j("./some.js")(f,b,c),j("./filter.js")(f,_),j("./each.js")(f,_),j("./any.js")(f),h.toFastProperties(f),h.toFastProperties(f.prototype),r({a:1}),r({b:2}),r({c:3}),r(1),r(function(){}),r(void 0),r(!1),r(new f(_)),C.setBounds(i.firstLineError,h.lastLineError),f}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(n,t,e){"use strict";t.exports=function(s,r,u,o,t){function e(t){var e=this._promise=new s(r);t instanceof s&&e._propagateFrom(t,3),e._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var a=n("./util");return a.isArray,a.inherits(e,t),e.prototype.length=function(){return this._length},e.prototype.promise=function(){return this._promise},e.prototype._init=function t(e,r){if((n=u(this._values,this._promise))instanceof s){var n,i=(n=n._target())._bitField;if(this._values=n,0==(50397184&i))return this._promise._setAsyncGuaranteed(),n._then(t,this._reject,void 0,this,r);if(0==(33554432&i))return 0!=(16777216&i)?this._reject(n._reason()):this._cancel();n=n._value()}if(null!==(n=a.asArray(n)))return 0===n.length?void(-5===r?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}(r))):void this._iterate(n);i=o("expecting an array or an iterable object but got "+a.classString(n)).reason(),this._promise._rejectCallback(i,!1)},e.prototype._iterate=function(t){var e=this.getActualLength(t.length);this._length=e,this._values=this.shouldCopyValues()?new Array(e):this._values;for(var r=this._promise,n=!1,i=null,o=0;o<e;++o){var a=u(t[o],r),i=a instanceof s?(a=a._target())._bitField:null;n?null!==i&&a.suppressUnhandledRejections():null!==i?0==(50397184&i)?(a._proxy(this,o),this._values[o]=a):n=0!=(33554432&i)?this._promiseFulfilled(a._value(),o):0!=(16777216&i)?this._promiseRejected(a._reason(),o):this._promiseCancelled(o):n=this._promiseFulfilled(a,o)}n||r._setAsyncGuaranteed()},e.prototype._isResolved=function(){return null===this._values},e.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},e.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},e.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},e.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},e.prototype._promiseCancelled=function(){return this._cancel(),!0},e.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},e.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof s)t.cancel();else for(var e=0;e<t.length;++e)t[e]instanceof s&&t[e].cancel()}},e.prototype.shouldCopyValues=function(){return!0},e.prototype.getActualLength=function(t){return t},e}},{"./util":36}],24:[function(r,t,e){"use strict";t.exports=function(c,l){function n(t){return!e.test(t)}function v(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function p(t,e,r,n){for(var i,o=m.inheritedDataKeys(t),a=[],s=0;s<o.length;++s){var u=o[s],c=t[u],l=n===C||C(u,c,t);"function"!=typeof c||v(c)||(i=t,(i=m.getDataPropertyOrDefault(i,u+e,w))&&v(i)||!n(u,c,t,l)||a.push(u,c))}for(var f=a,h=e,p=r,d=0;d<f.length;d+=2){var y=f[d];if(p.test(y))for(var _=y.replace(p,""),g=0;g<f.length;g+=2)if(f[g]===_)throw new b("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",h))}return a}function f(t,e,r,n,i){for(var o=new RegExp(e.replace(/([$])/,"\\$")+"$"),a=p(t,e,o,r),s=0,u=a.length;s<u;s+=2){var c,l=a[s],f=a[s+1],h=l+e;n===g?t[h]=g(l,d,l,f,e,i):(c=n(f,function(){return g(l,d,l,f,e,i)}),m.notEnumerableProp(c,"__isPromisified__",!0),t[h]=c)}return m.toFastProperties(t),t}var d={},m=r("./util"),h=r("./nodeback"),y=m.withAppended,_=m.maybeWrapAsError,t=m.canEvaluate,b=r("./errors").TypeError,w={__isPromisified__:!0},e=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),C=function(t){return m.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},g=t?void 0:function(i,o,t,e,r,a){function n(){var t=o,e=(o===d&&(t=this),new c(l)),r=(e._captureStackTrace(),"string"==typeof u&&this!==s?this[u]:i),n=h(e,a);try{r.apply(t,y(arguments,n))}catch(t){e._rejectCallback(_(t),!0,!0)}return e._isFateSealed()||e._setAsyncGuaranteed(),e}var s=function(){return this}(),u=i;return"string"==typeof u&&(i=e),m.notEnumerableProp(n,"__isPromisified__",!0),n};c.promisify=function(t,e){if("function"!=typeof t)throw new b("expecting a function but got "+m.classString(t));var r;return v(t)?t:(r=void 0===(e=Object(e)).context?d:e.context,e=!!e.multiArgs,r=g(t,r,void 0,t,null,e),m.copyDescriptors(t,r,n),r)},c.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new b("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var r=!!(e=Object(e)).multiArgs,n=e.suffix,i=e.filter,o=("function"!=typeof i&&(i=C),e.promisifier);if("function"!=typeof o&&(o=g),!m.isIdentifier(n="string"!=typeof n?"Async":n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=m.inheritedDataKeys(t),s=0;s<a.length;++s){var u=t[a[s]];"constructor"!==a[s]&&m.isClass(u)&&(f(u.prototype,n,i,o,r),f(u,n,i,o,r))}return f(t,n,i,o,r)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(d,t,e){"use strict";t.exports=function(r,t,n,i){function o(t){var e=!1;if(void 0!==s&&t instanceof s)i=h(t),e=!0;else for(var r=f.keys(t),n=r.length,i=new Array(2*n),o=0;o<n;++o){var a=r[o];i[o]=t[a],i[o+n]=a}this.constructor$(i),this._isMap=e,this._init$(void 0,e?-6:-3)}function e(t){var e,t=n(t);return l(t)?(e=t instanceof r?t._then(r.props,void 0,void 0,void 0,void 0):new o(t).promise(),t instanceof r&&e._propagateFrom(t,2),e):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var s,a,u,c=d("./util"),l=c.isObject,f=d("./es5"),h=("function"==typeof Map&&(s=Map),u=0,function(t){a=t.size,u=0;var e=new Array(2*t.size);return t.forEach(p,e),e});function p(t,e){this[u]=t,this[u+a]=e,u++}c.inherits(o,t),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){if(this._isMap)r=function(t){for(var e=new s,r=t.length/2|0,n=0;n<r;++n){var i=t[r+n],o=t[n];e.set(i,o)}return e}(this._values);else for(var r={},n=this.length(),i=0,o=this.length();i<o;++i)r[this._values[i+n]]=this._values[i];return this._resolve(r),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(t){return t>>1},r.prototype.props=function(){return e(this)},r.props=e}},{"./es5":13,"./util":36}],26:[function(t,e,r){"use strict";function n(t){this._capacity=t,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(t){return this._capacity<t},n.prototype._pushOne=function(t){var e=this.length(),r=(this._checkCapacity(e+1),this._front+e&this._capacity-1);this[r]=t,this._length=e+1},n.prototype.push=function(t,e,r){var n,i,o=this.length()+3;this._willBeOverCapacity(o)?(this._pushOne(t),this._pushOne(e),this._pushOne(r)):(n=this._front+o-3,this._checkCapacity(o),i=this._capacity-1,this[n&i]=t,this[1+n&i]=e,this[2+n&i]=r,this._length=o)},n.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;for(var t=this._front+this._length&e-1,r=this,n=0,i=this,o=e,a=t,s=0;s<a;++s)i[s+o]=r[s+n],r[s+n]=void 0},e.exports=n},{}],27:[function(t,e,r){"use strict";e.exports=function(c,l,f,h){function r(t,e){var r=f(t);if(r instanceof c)return p(r);if(null===(t=d.asArray(t)))return h("expecting an array or an iterable object but got "+d.classString(t));var n=new c(l);void 0!==e&&n._propagateFrom(e,3);for(var i=n._fulfill,o=n._reject,a=0,s=t.length;a<s;++a){var u=t[a];(void 0!==u||a in t)&&c.cast(u)._then(i,o,void 0,n,null)}return n}function p(e){return e.then(function(t){return r(t,e)})}var d=t("./util");c.race=function(t){return r(t,void 0)},c.prototype.race=function(){return r(this,void 0)}}},{"./util":36}],28:[function(d,t,e){"use strict";t.exports=function(o,t,i,e,a,s){function u(t,e,r,n){this.constructor$(t);t=f();this._fn=null===t?e:h.domainBind(t,e),void 0!==r&&(r=o.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=n===a?Array(this._length):0===n?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function c(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function r(t,e,r,n){return"function"!=typeof e?i("expecting a function but got "+h.classString(e)):new u(t,e,r,n).promise()}function l(t){this.accum=t,this.array._gotAccum(t);t=e(this.value,this.array._promise);return t instanceof o?(this.array._currentCancellable=t)._then(n,void 0,void 0,this,void 0):n.call(this,t)}function n(t){var e=this.array,r=e._promise,n=p(e._fn),t=(r._pushContext(),(n=void 0!==e._eachValues?n.call(r._boundValue(),t,this.index,this.length):n.call(r._boundValue(),this.accum,t,this.index,this.length))instanceof o&&(e._currentCancellable=n),r._popContext());return s.checkForgottenReturns(n,t,void 0!==e._eachValues?"Promise.each":"Promise.reduce",r),n}var f=o._getDomain,h=d("./util"),p=h.tryCatch;h.inherits(u,t),u.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==a&&this._eachValues.push(t)},u.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},u.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof o&&this._currentCancellable.cancel(),this._initialValue instanceof o&&this._initialValue.cancel()))},u.prototype._iterate=function(t){var e=(this._values=t).length,r=void 0!==this._initialValue?(i=this._initialValue,0):(i=o.resolve(t[0]),1);if(!(this._currentCancellable=i).isRejected())for(;r<e;++r)var n={accum:null,value:t[r],index:r,length:e,array:this},i=i._then(l,void 0,void 0,n,void 0);(i=void 0!==this._eachValues?i._then(this._eachComplete,void 0,void 0,this,void 0):i)._then(c,c,void 0,i,this)},o.prototype.reduce=function(t,e){return r(this,t,e,null)},o.reduce=r}},{"./util":36}],29:[function(t,e,r){"use strict";var n,i,o,t=t("./util"),a=t.getNativePromise();t=t.isNode&&"undefined"==typeof MutationObserver?(n=global.setImmediate,i=process.nextTick,t.isRecentNode?function(t){n.call(global,t)}:function(t){i.call(process,t)}):"function"==typeof a&&"function"==typeof a.resolve?(o=a.resolve(),function(t){o.then(t)}):"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var r=document.createElement("div"),n={attributes:!0},i=!1,o=document.createElement("div");new MutationObserver(function(){r.classList.toggle("foo"),i=!1}).observe(o,n);return function(t){var e=new MutationObserver(function(){e.disconnect(),t()});e.observe(r,n),i||(i=!0,o.classList.toggle("foo"))}}(),e.exports=t},{"./util":36}],30:[function(o,t,e){"use strict";t.exports=function(t,e,r){function n(t){this.constructor$(t)}var i=t.PromiseInspection;o("./util").inherits(n,e),n.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},n.prototype._promiseFulfilled=function(t,e){var r=new i;return r._bitField=33554432,r._settledValueField=t,this._promiseResolved(e,r)},n.prototype._promiseRejected=function(t,e){var r=new i;return r._bitField=16777216,r._settledValueField=t,this._promiseResolved(e,r)},t.settle=function(t){return r.deprecated(".settle()",".reflect()"),new n(t).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(l,t,e){"use strict";t.exports=function(t,e,n){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function r(t,e){var r;return(0|e)!==e||e<0?n("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n"):(r=(t=new i(t)).promise(),t.setHowMany(e),t.init(),r)}var o=l("./util"),a=l("./errors").RangeError,s=l("./errors").AggregateError,u=o.isArray,c={};o.inherits(i,e),i.prototype._init=function(){var t;this._initialized&&(0===this._howMany?this._resolve([]):(this._init$(void 0,-5),t=u(this._values),!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))))},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._howMany=t},i.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},i.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new s,e=this.length();e<this._values.length;++e)this._values[e]!==c&&t.push(this._values[e]);return 0<t.length?this._reject(t):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){t="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(t)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=r,t.prototype.some=function(t){return r(this,t)},t._SomePromiseArray=i}},{"./errors":12,"./util":36}],32:[function(t,e,r){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var r=e.prototype.value=function(){if(this.isFulfilled())return this._settledValue();throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n")},n=e.prototype.error=e.prototype.reason=function(){if(this.isRejected())return this._settledValue();throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n")},i=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},a=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return a.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return s.call(this._target())},t.prototype.value=function(){return r.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),n.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,r){"use strict";e.exports=function(s,u){var c=t("./util"),l=c.errorObj,f=c.isObject,h={}.hasOwnProperty;return function(t,e){if(f(t)){if(t instanceof s)return t;var r=function(t){try{return t.then}catch(t){return l.e=t,l}}(t);if(r===l)return e&&e._pushContext(),n=s.reject(r.e),e&&e._popContext(),n;if("function"==typeof r)return function(t){try{return h.call(t,"_promise0")}catch(t){}}(t)?(n=new s(u),t._then(n._fulfill,n._reject,void 0,n,null),n):(n=t,r=r,e=e,i=new s(u),o=i,e&&e._pushContext(),i._captureStackTrace(),e&&e._popContext(),a=!0,e=c.tryCatch(r).call(n,function(t){i&&(i._resolveCallback(t),i=null)},function(t){i&&(i._rejectCallback(t,a,!0),i=null)}),a=!1,i&&e===l&&(i._rejectCallback(e.e,!0,!0),i=null),o)}var n,i,o,a;return t}}},{"./util":36}],34:[function(t,e,r){"use strict";e.exports=function(n,i,a){function s(t){this.handle=t}function e(t){return clearTimeout(this.handle),t}function r(t){throw clearTimeout(this.handle),t}function o(t){return l(+this).thenReturn(t)}var u=t("./util"),c=n.TimeoutError,l=(s.prototype._resultCancelled=function(){clearTimeout(this.handle)},n.delay=function(t,e){var r;return void 0!==e?(r=n.resolve(e)._then(o,null,null,t,void 0),a.cancellation()&&e instanceof n&&r._setOnCancel(e)):(r=new n(i),e=setTimeout(function(){r._fulfill()},+t),a.cancellation()&&r._setOnCancel(new s(e)),r._captureStackTrace()),r._setAsyncGuaranteed(),r});n.prototype.delay=function(t){return l(t,this)};n.prototype.timeout=function(t,n){t=+t;var i,o,t=new s(setTimeout(function(){var t,e,r;i.isPending()&&(t=i,r=o,e="string"!=typeof(e=n)?e instanceof Error?e:new c("operation timed out"):new c(e),u.markAsOriginatingFromRejection(e),t._attachExtraTrace(e),t._reject(e),null!=r&&r.cancel())},t));return a.cancellation()?(o=this.then(),(i=o._then(e,r,void 0,t,void 0))._setOnCancel(t)):i=this._then(e,r,void 0,t,void 0),i}}},{"./util":36}],35:[function(a,t,e){"use strict";t.exports=function(f,h,p,e,t,d){function u(t){setTimeout(function(){throw t},0)}function y(n,i){var o=0,a=n.length,s=new f(t);return function t(){if(a<=o)return s._fulfill();r=n[o++],(e=p(r))!==r&&"function"==typeof r._isDisposable&&"function"==typeof r._getDisposer&&r._isDisposable()&&e._setDisposable(r._getDisposer());var e,r=e;if(r instanceof f&&r._isDisposable()){try{r=p(r._getDisposer().tryDispose(i),n.promise)}catch(t){return u(t)}if(r instanceof f)return r._then(t,u,null,null,null)}t()}(),s}function _(t,e,r){this._data=t,this._promise=e,this._context=r}function r(t,e,r){this.constructor$(t,e,r)}function g(t){return _.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function v(t){this.length=t,this.promise=null,this[t-1]=null}var m=a("./util"),n=a("./errors").TypeError,i=a("./util").inherits,b=m.errorObj,w=m.tryCatch,o={};_.prototype.data=function(){return this._data},_.prototype.promise=function(){return this._promise},_.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():o},_.prototype.tryDispose=function(t){var e=this.resource(),r=this._context,e=(void 0!==r&&r._pushContext(),e!==o?this.doDispose(e,t):null);return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,e},_.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},i(r,_),r.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},v.prototype._resultCancelled=function(){for(var t=this.length,e=0;e<t;++e){var r=this[e];r instanceof f&&r.cancel()}},f.using=function(){var t=arguments.length;if(t<2)return h("you must pass at least 2 arguments to Promise.using");var o=arguments[t-1];if("function"!=typeof o)return h("expecting a function but got "+m.classString(o));var e,a=!0;2===t&&Array.isArray(arguments[0])?(t=(e=arguments[0]).length,a=!1):(e=arguments,t--);for(var r=new v(t),n=0;n<t;++n){var i,s=e[n];_.isDisposer(s)?(s=(i=s).promise())._setDisposable(i):(i=p(s))instanceof f&&(s=i._then(g,null,null,{resources:r,index:n},void 0)),r[n]=s}for(var u=new Array(r.length),n=0;n<u.length;++n)u[n]=f.resolve(r[n]).reflect();var c=f.all(u).then(function(t){for(var e=0;e<t.length;++e){var r=t[e];if(r.isRejected())return b.e=r.error(),b;if(!r.isFulfilled())return void c.cancel();t[e]=r.value()}l._pushContext(),o=w(o);var n=a?o.apply(void 0,t):o(t),i=l._popContext();return d.checkForgottenReturns(n,i,"Promise.using",l),n}),l=c.lastly(function(){var t=new f.PromiseInspection(c);return y(r,t)});return(r.promise=l)._setOnCancel(r),l},f.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},f.prototype._isDisposable=function(){return 0<(131072&this._bitField)},f.prototype._getDisposer=function(){return this._disposer},f.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},f.prototype.disposer=function(t){if("function"==typeof t)return new r(t,this,e());throw new n}}},{"./errors":12,"./util":36}],36:[function(t,e,r){"use strict";function n(){try{var t=l;return l=null,t.apply(this,arguments)}catch(t){return _.e=t,_}}function i(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function o(t,e,r){return i(t)||y.defineProperty(t,e,{value:r,configurable:!0,enumerable:!1,writable:!0}),t}function a(t){try{return t+""}catch(t){return"[no string representation]"}}function s(t){return null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function u(t){return s(t)&&y.propertyIsWritable(t,"stack")}function c(t){return{}.toString.call(t)}var l,f,h,p,d,y=t("./es5"),t="undefined"==typeof navigator,_={e:{}},g="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,v=(p=[Array.prototype,Object.prototype,Function.prototype],y.isES5?(f=Object.getOwnPropertyNames,function(t){for(var e,r=[],n=Object.create(null);null!=t&&!A(t);){try{e=f(t)}catch(t){return r}for(var i=0;i<e.length;++i){var o,a=e[i];n[a]||(n[a]=!0,null!=(o=Object.getOwnPropertyDescriptor(t,a))&&null==o.get&&null==o.set&&r.push(a))}t=y.getPrototypeOf(t)}return r}):(h={}.hasOwnProperty,function(t){if(A(t))return[];var e=[];t:for(var r in t){if(!h.call(t,r))for(var n=0;n<p.length;++n)if(h.call(p[n],r))continue t;e.push(r)}return e})),m=/this\s*\.\s*\S+\s*=/,b=/^[a-z$_][a-z$_0-9]*$/i,w="stack"in new Error?function(t){return u(t)?t:new Error(a(t))}:function(t){if(u(t))return t;try{throw new Error(a(t))}catch(t){return t}},C=function(t){return y.isArray(t)?t:null};function A(t){for(var e=0;e<p.length;++e)if(p[e]===t)return 1}"undefined"!=typeof Symbol&&Symbol.iterator&&(d="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,r=[],n=t[Symbol.iterator]();!(e=n.next()).done;)r.push(e.value);return r},C=function(t){return y.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?d(t):null});var S="undefined"!=typeof process&&"[object process]"===c(process).toLowerCase(),k="undefined"!=typeof process&&void 0!==process.env,v={isClass:function(t){try{if("function"==typeof t){var e=y.names(t.prototype),r=y.isES5&&1<e.length,n=0<e.length&&!(1===e.length&&"constructor"===e[0]),i=m.test(t+"")&&0<y.names(t).length;if(r||n||i)return!0}return!1}catch(t){return!1}},isIdentifier:function(t){return b.test(t)},inheritedDataKeys:v,getDataPropertyOrDefault:function(t,e,r){var n;return y.isES5?null!=(n=Object.getOwnPropertyDescriptor(t,e))?null==n.get&&null==n.set?n.value:r:void 0:{}.hasOwnProperty.call(t,e)?t[e]:void 0},thrower:function(t){throw t},isArray:y.isArray,asArray:C,notEnumerableProp:o,isPrimitive:i,isObject:function(t){return"function"==typeof t||"object"==typeof t&&null!==t},isError:s,canEvaluate:t,errorObj:_,tryCatch:function(t){return l=t,n},inherits:function(e,r){function t(){for(var t in this.constructor=e,(this.constructor$=r).prototype)n.call(r.prototype,t)&&"$"!==t.charAt(t.length-1)&&(this[t+"$"]=r.prototype[t])}var n={}.hasOwnProperty;return t.prototype=r.prototype,e.prototype=new t,e.prototype},withAppended:function(t,e){for(var r=t.length,n=new Array(r+1),i=0;i<r;++i)n[i]=t[i];return n[i]=e,n},maybeWrapAsError:function(t){return i(t)?new Error(a(t)):t},toFastProperties:function(t){for(var e=8;e--;);return t},filledRange:function(t,e,r){for(var n=new Array(t),i=0;i<t;++i)n[i]=e+i+r;return n},toString:a,canAttachTrace:u,ensureErrorObject:w,originatesFromRejection:function(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)},markAsOriginatingFromRejection:function(t){try{o(t,"isOperational",!0)}catch(t){}},classString:c,copyDescriptors:function(t,e,r){for(var n=y.names(t),i=0;i<n.length;++i){var o=n[i];if(r(o))try{y.defineProperty(e,o,y.getDescriptor(t,o))}catch(t){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:S,hasEnvVariables:k,env:function(t){return k?process.env[t]:void 0},global:g,getNativePromise:function(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}},domainBind:function(t,e){return t.bind(e)}};v.isRecentNode=v.isNode&&(0===(C=process.versions.node.split(".").map(Number))[0]&&10<C[1]||0<C[0]),v.isNode&&v.toFastProperties(process);try{throw new Error}catch(t){v.lastLineError=t}e.exports=v},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)),function(t,e){"function"==typeof define&&define.amd?define([],function(){return e(t)}):"object"==typeof module&&module.exports?module.exports=e(t):e(t)}("undefined"!=typeof self?self:this,function(t){"use strict";function f(t){return btoa(t).replace(/\=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function h(t){return t=(t+="===").slice(0,-t.length%4),atob(t.replace(/-/g,"+").replace(/_/g,"/"))}function p(t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function d(t){return t instanceof ArrayBuffer&&(t=new Uint8Array(t)),String.fromCharCode.apply(String,t)}function y(t){var e={name:(t.name||t||"").toUpperCase().replace("V","v")};switch(e.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":t.length&&(e.length=t.length);break;case"HMAC":t.hash&&(e.hash=y(t.hash)),t.length&&(e.length=t.length);break;case"RSAES-PKCS1-v1_5":t.publicExponent&&(e.publicExponent=new Uint8Array(t.publicExponent)),t.modulusLength&&(e.modulusLength=t.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":t.hash&&(e.hash=y(t.hash)),t.publicExponent&&(e.publicExponent=new Uint8Array(t.publicExponent)),t.modulusLength&&(e.modulusLength=t.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return e}function _(t){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[t.name][(t.hash||{}).name||t.length||""]}function g(e){var r={kty:(e=e instanceof ArrayBuffer||e instanceof Uint8Array?JSON.parse(decodeURIComponent(escape(d(e)))):e).kty,alg:e.alg,ext:e.ext||e.extractable};switch(r.kty){case"oct":r.k=e.k;case"RSA":["n","e","d","p","q","dp","dq","qi","oth"].forEach(function(t){t in e&&(r[t]=e[t])});break;default:throw new TypeError("Unsupported key type")}return r}function v(t,e){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(e=e||{pos:0,end:t.length}).end-e.pos<2||e.end>t.length)throw new RangeError("Malformed DER");var r=t[e.pos++],n=t[e.pos++];if(128<=n){if(e.end-e.pos<(n&=127))throw new RangeError("Malformed DER");for(var i=0;n--;)i=(i<<=8)|t[e.pos++];n=i}if(e.end-e.pos<n)throw new RangeError("Malformed DER");switch(r){case 2:a=t.subarray(e.pos,e.pos+=n);break;case 3:if(t[e.pos++])throw new Error("Unsupported bit string");n--;case 4:a=new Uint8Array(t.subarray(e.pos,e.pos+=n)).buffer;break;case 5:a=null;break;case 6:var o=btoa(d(t.subarray(e.pos,e.pos+=n)));if(!(o in c))throw new Error("Unsupported OBJECT ID "+o);a=c[o];break;case 48:for(var a=[],s=e.pos+n;e.pos<s;)a.push(v(t,e));break;default:throw new Error("Unsupported DER tag 0x"+r.toString(16))}return a}function u(t,e){var r=0,n=0,i=(e=e||[]).length+2;if(e.push(0,0),t instanceof Uint8Array)for(r=2,n=t.length,a=0;a<n;a++)e.push(t[a]);else if(t instanceof ArrayBuffer)for(r=4,n=t.byteLength,t=new Uint8Array(t),a=0;a<n;a++)e.push(t[a]);else if(null===t)r=5,n=0;else if("string"==typeof t&&t in l){var o=p(atob(l[t])),r=6;for(n=o.length,a=0;a<n;a++)e.push(o[a])}else if(t instanceof Array){for(a=0;a<t.length;a++)u(t[a],e);r=48,n=e.length-i}else{if(!("object"==typeof t&&3===t.tag&&t.value instanceof ArrayBuffer))throw new Error("Unsupported DER value "+t);r=3,n=(t=new Uint8Array(t.value)).byteLength,e.push(0);for(var a=0;a<n;a++)e.push(t[a]);n++}if(128<=n){var s=n,n=4;for(e.splice(i,0,s>>24&255,s>>16&255,s>>8&255,255&s);1<n&&!(s>>24);)s<<=8,n--;n<4&&e.splice(i,4-n),n|=128}return e.splice(i-2,2,r,n),e}function m(t,e,r,n){Object.defineProperties(this,{_key:{value:t},type:{value:t.type,enumerable:!0},extractable:{value:void 0===r?t.extractable:r,enumerable:!0},algorithm:{value:void 0===e?t.algorithm:e,enumerable:!0},usages:{value:void 0===n?t.usages:n,enumerable:!0}})}function b(t){return"verify"===t||"encrypt"===t||"wrapKey"===t}function w(t){return"sign"===t||"decrypt"===t||"unwrapKey"===t}if("function"!=typeof Promise)throw"Promise support required";var C,e,r,n,A,S,c,l,i,k=t.crypto||t.msCrypto;k&&(C=k.subtle||k.webkitSubtle)&&(e=t.Crypto||k.constructor||Object,r=t.SubtleCrypto||C.constructor||Object,t.CryptoKey||t.Key||Object,n=-1<t.navigator.userAgent.indexOf("Edge/"),A=!!t.msCrypto&&!n,S=!k.subtle&&!!k.webkitSubtle,(A||S)&&(c={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},l={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"},["generateKey","importKey","unwrapKey"].forEach(function(c){var l=C[c];C[c]=function(e,a,t){var r,n,i,o,s,u=[].slice.call(arguments);switch(c){case"generateKey":r=y(e),n=a,i=t;break;case"importKey":r=y(t),n=u[3],i=u[4],"jwk"===e&&((a=g(a)).alg||(a.alg=_(r)),a.key_ops||(a.key_ops="oct"!==a.kty?"d"in a?i.filter(w):i.filter(b):i.slice()),u[1]=(o=g(a),A&&(o.extractable=o.ext,delete o.ext),p(unescape(encodeURIComponent(JSON.stringify(o)))).buffer));break;case"unwrapKey":r=u[4],n=u[5],i=u[6],u[2]=t._key||t}if("generateKey"===c&&"HMAC"===r.name&&r.hash)return r.length=r.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[r.hash.name],C.importKey("raw",k.getRandomValues(new Uint8Array(r.length+7>>3)),r,n,i);if(S&&"generateKey"===c&&"RSASSA-PKCS1-v1_5"===r.name&&(!r.modulusLength||2048<=r.modulusLength))return(e=y(e)).name="RSAES-PKCS1-v1_5",delete e.hash,C.generateKey(e,!0,["encrypt","decrypt"]).then(function(t){return Promise.all([C.exportKey("jwk",t.publicKey),C.exportKey("jwk",t.privateKey)])}).then(function(t){return t[0].alg=t[1].alg=_(r),t[0].key_ops=i.filter(b),t[1].key_ops=i.filter(w),Promise.all([C.importKey("jwk",t[0],r,!0,t[0].key_ops),C.importKey("jwk",t[1],r,n,t[1].key_ops)])}).then(function(t){return{publicKey:t[0],privateKey:t[1]}});if((S||A&&"SHA-1"===(r.hash||{}).name)&&"importKey"===c&&"jwk"===e&&"HMAC"===r.name&&"oct"===a.kty)return C.importKey("raw",p(h(a.k)),t,u[3],u[4]);if(S&&"importKey"===c&&("spki"===e||"pkcs8"===e))return C.importKey("jwk",function(){var t=v(a),e=!1,r=(2<t.length&&(e=!0,t.shift()),{ext:!0});if("1.2.840.113549.1.1.1"!==t[0][0])throw new TypeError("Unsupported key type");var n=["n","e","d","p","q","dp","dq","qi"],i=v(t[1]);e&&i.shift();for(var o=0;o<i.length;o++)i[o][0]||(i[o]=i[o].subarray(1)),r[n[o]]=f(d(i[o]));return r.kty="RSA",r}(),t,u[3],u[4]);if(A&&"unwrapKey"===c)return C.decrypt(u[3],t,a).then(function(t){return C.importKey(e,t,u[4],u[5],u[6])});try{s=l.apply(C,u)}catch(t){return Promise.reject(t)}return s=(s=A?new Promise(function(e,r){s.onabort=s.onerror=function(t){r(t)},s.oncomplete=function(t){e(t.target.result)}}):s).then(function(t){return"HMAC"!==r.name||r.length||(r.length=8*t.algorithm.length),0==r.name.search("RSA")&&(r.modulusLength||(r.modulusLength=(t.publicKey||t).algorithm.modulusLength),r.publicExponent||(r.publicExponent=(t.publicKey||t).algorithm.publicExponent)),t.publicKey&&t.privateKey?{publicKey:new m(t.publicKey,r,n,i.filter(b)),privateKey:new m(t.privateKey,r,n,i.filter(w))}:new m(t,r,n,i)})}}),["exportKey","wrapKey"].forEach(function(o){var a=C[o];C[o]=function(e,r,n){var t,i=[].slice.call(arguments);switch(o){case"exportKey":i[1]=r._key||r;break;case"wrapKey":i[1]=r._key||r,i[2]=n._key||n}if((S||A&&"SHA-1"===(r.algorithm.hash||{}).name)&&"exportKey"===o&&"jwk"===e&&"HMAC"===r.algorithm.name&&(i[0]="raw"),!S||"exportKey"!==o||"spki"!==e&&"pkcs8"!==e||(i[0]="jwk"),A&&"wrapKey"===o)return C.exportKey(e,r).then(function(t){return"jwk"===e&&(t=p(unescape(encodeURIComponent(JSON.stringify(g(t)))))),C.encrypt(i[3],n,t)});try{t=a.apply(C,i)}catch(t){return Promise.reject(t)}return A&&(t=new Promise(function(e,r){t.onabort=t.onerror=function(t){r(t)},t.oncomplete=function(t){e(t.target.result)}})),"exportKey"===o&&"jwk"===e&&(t=t.then(function(t){return(S||A&&"SHA-1"===(r.algorithm.hash||{}).name)&&"HMAC"===r.algorithm.name?{kty:"oct",alg:_(r.algorithm),key_ops:r.usages.slice(),ext:!0,k:f(d(t))}:((t=g(t)).alg||(t.alg=_(r.algorithm)),t.key_ops||(t.key_ops="public"===r.type?r.usages.filter(b):"private"===r.type?r.usages.filter(w):r.usages.slice()),t)})),t=!S||"exportKey"!==o||"spki"!==e&&"pkcs8"!==e?t:t.then(function(t){var e=g(t),t=[["",null]],r=!1;if("RSA"!==e.kty)throw new TypeError("Unsupported key type");for(var n=["n","e","d","p","q","dp","dq","qi"],i=[],o=0;o<n.length&&n[o]in e;o++){var a=i[o]=p(h(e[n[o]]));128&a[0]&&(i[o]=new Uint8Array(a.length+1),i[o].set(a,1))}return 2<i.length&&(r=!0,i.unshift(new Uint8Array([0]))),t[0][0]="1.2.840.113549.1.1.1",t.push(new Uint8Array(u(i)).buffer),r?t.unshift(new Uint8Array([0])):t[1]={tag:3,value:t[1]},new Uint8Array(u(t)).buffer})}}),["encrypt","decrypt","sign","verify"].forEach(function(a){var s=C[a];C[a]=function(t,e,r,n){if(A&&(!r.byteLength||n&&!n.byteLength))throw new Error("Empy input is not allowed");var i,n=[].slice.call(arguments),o=y(t);A&&"decrypt"===a&&"AES-GCM"===o.name&&(o=t.tagLength>>3,n[2]=(r.buffer||r).slice(0,r.byteLength-o),t.tag=(r.buffer||r).slice(r.byteLength-o)),n[1]=e._key||e;try{i=s.apply(C,n)}catch(t){return Promise.reject(t)}return i=A?new Promise(function(n,e){i.onabort=i.onerror=function(t){e(t)},i.oncomplete=function(t){var e,r;t=t.target.result,"encrypt"===a&&t instanceof AesGcmEncryptResult&&(e=t.ciphertext,r=t.tag,(t=new Uint8Array(e.byteLength+r.byteLength)).set(new Uint8Array(e),0),t.set(new Uint8Array(r),e.byteLength),t=t.buffer),n(t)}}):i}}),A&&(i=C.digest,C.digestOriginal=i,C.digest=function(t,e){if(!e.byteLength)throw new Error("Empy input is not allowed");var n;try{n=i.call(C,t,e)}catch(t){return Promise.reject(t)}return n=new Promise(function(e,r){n.onabort=n.onerror=function(t){r(t)},n.oncomplete=function(t){e(t.target.result)}})},t.crypto=Object.create(k,{getRandomValues:{value:function(t){return k.getRandomValues(t)}},subtle:{value:C}}),t.CryptoKey=m),S&&(k.subtle=C,t.Crypto=e,t.SubtleCrypto=r,t.CryptoKey=m)))}),function(){function t(){}t[2029]=function(){for(var e,t=2;9!==t;)switch(t){case 2:t="object"==typeof globalThis?1:5;break;case 1:return globalThis;case 5:try{for(var r=2;6!==r;)switch(r){case 4:r="undefined"==typeof $Oc3V?3:9;break;case 2:Object.defineProperty(Object.prototype,"yf5EU",{get:function(){return this},configurable:!0}),(e=yf5EU).$Oc3V=e,r=4;break;case 3:throw"";case 9:delete e.$Oc3V,delete Object.prototype.yf5EU,r=6}}catch(t){e=window}return e}}(),t[647802]="hwu",(t[2029].R6dd=t)[497164]=!1,t[378901]="rWk",t[86098]="n$9",t[485967]=764,t[542895]=!1,t[547016]="IMS",t[242600]=t[2029],t[389773]=187;var r,i,e,n,o="util";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return a(finForge="undefined"==typeof finForge?{}:finForge);r=!0,define=function(t,e){e(require,module)}}function a(t){var p,r,u,f,a,s,o,i,c,n,l,h;function d(t){var e;if(this.data="",this.read=0,"string"==typeof t)this.data=t;else if(p.isArrayBuffer(t)||p.isArrayBufferView(t)){e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(t){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof d||"object"==typeof t&&"string"==typeof t.data&&"number"==typeof t.read)&&(this.data=t.data,this.read=t.read)}p=t.util=t.util||{},"undefined"!=typeof process&&process.nextTick?(p.nextTick=process.nextTick,"function"==typeof setImmediate?p.setImmediate=setImmediate:p.setImmediate=p.nextTick):"function"==typeof setImmediate?(p.setImmediate=setImmediate,p.nextTick=function(t){return setImmediate(t)}):(p.setImmediate=function(t){setTimeout(t,0)},p.nextTick=p.setImmediate),p.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},p.isArrayBuffer=function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer},r=[],"undefined"!=typeof DataView&&r.push(DataView),"undefined"!=typeof Int8Array&&r.push(Int8Array),"undefined"!=typeof Uint8Array&&r.push(Uint8Array),"undefined"!=typeof Uint8ClampedArray&&r.push(Uint8ClampedArray),"undefined"!=typeof Int16Array&&r.push(Int16Array),"undefined"!=typeof Uint16Array&&r.push(Uint16Array),"undefined"!=typeof Int32Array&&r.push(Int32Array),"undefined"!=typeof Uint32Array&&r.push(Uint32Array),"undefined"!=typeof Float32Array&&r.push(Float32Array),"undefined"!=typeof Float64Array&&r.push(Float64Array),p.isArrayBufferView=function(t){for(var e=0;e<r.length;++e)if(t instanceof r[e])return!0;return!1},p.ByteBuffer=d,p.ByteStringBuffer=d,p.ByteStringBuffer.prototype.toArrayBuffer=function(){for(var t=new ArrayBuffer(this.data.length),e=new Uint8Array(t),r=0;r<this.data.length;r++)e[r]=this.data.charCodeAt(r);return t},p.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},p.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},p.ByteStringBuffer.prototype.putByte=function(t){return this.data+=String.fromCharCode(t),this},p.ByteStringBuffer.prototype.fillWithByte=function(t,e){var r;for(t=String.fromCharCode(t),r=this.data;0<e;)1&e&&(r+=t),0<(e>>>=1)&&(t+=t);return this.data=r,this},p.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this},p.ByteStringBuffer.prototype.putString=function(t){return this.data+=p.encodeUtf8(t),this},p.ByteStringBuffer.prototype.putInt16=function(t){return this.data+=String.fromCharCode(t>>8&255)+String.fromCharCode(255&t),this},p.ByteStringBuffer.prototype.putInt24=function(t){return this.data+=String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t),this},p.ByteStringBuffer.prototype.putInt32=function(t){return this.data+=String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t),this},p.ByteStringBuffer.prototype.putInt16Le=function(t){return this.data+=String.fromCharCode(255&t)+String.fromCharCode(t>>8&255),this},p.ByteStringBuffer.prototype.putInt24Le=function(t){return this.data+=String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255),this},p.ByteStringBuffer.prototype.putInt32Le=function(t){return this.data+=String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255),this},p.ByteStringBuffer.prototype.putInt=function(t,e){for(;e-=8,this.data+=String.fromCharCode(t>>e&255),0<e;);return this},p.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)},p.ByteStringBuffer.prototype.putBuffer=function(t){return this.data+=t.getBytes(),this},p.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},p.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t},p.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t},p.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t},p.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t},p.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t},p.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t},p.ByteStringBuffer.prototype.getInt=function(t){for(var e=0;e=(e<<8)+this.data.charCodeAt(this.read++),0<(t-=8););return e},p.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),t=2<<t-2;return t<=e&&(e-=t<<1),e},p.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},p.ByteStringBuffer.prototype.bytes=function(t){return void 0===t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},p.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)},p.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this},p.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},p.ByteStringBuffer.prototype.copy=function(){var t=p.createBuffer(this.data);return t.read=this.read,t},p.ByteStringBuffer.prototype.compact=function(){return 0<this.read&&(this.data=this.data.slice(this.read),this.read=0),this},p.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},p.ByteStringBuffer.prototype.truncate=function(t){t=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,t),this.read=0,this},p.ByteStringBuffer.prototype.toHex=function(){for(var t,e="",r=this.read;r<this.data.length;++r)(t=this.data.charCodeAt(r))<16&&(e+="0"),e+=t.toString(16);return e},p.ByteStringBuffer.prototype.toString=function(){return p.decodeUtf8(this.bytes())},p.DataBuffer=function(t,e){var r,n;e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024,r=p.isArrayBuffer(t),n=p.isArrayBufferView(t),r||n?(this.data=r?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=t&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset))},p.DataBuffer.prototype.length=function(){return this.write-this.read},p.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},p.DataBuffer.prototype.accommodate=function(t,e){return this.length()>=t||(e=Math.max(e||this.growSize,t),t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),(e=new Uint8Array(this.length()+e)).set(t),this.data=new DataView(e.buffer)),this},p.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this},p.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this},p.DataBuffer.prototype.putBytes=function(t,e){var r,n,i;if(p.isArrayBufferView(t))return n=(r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)).byteLength-r.byteOffset,this.accommodate(n),new Uint8Array(this.data.buffer,this.write).set(r),this.write+=n,this;if(p.isArrayBuffer(t))return r=new Uint8Array(t),this.accommodate(r.byteLength),new Uint8Array(this.data.buffer).set(r,this.write),this.write+=r.byteLength,this;if(t instanceof p.DataBuffer||"object"==typeof t&&"number"==typeof t.read&&"number"==typeof t.write&&p.isArrayBufferView(t.data))return r=new Uint8Array(t.data.byteLength,t.read,t.length()),this.accommodate(r.byteLength),new Uint8Array(t.data.byteLength,this.write).set(r),this.write+=r.byteLength,this;if(t instanceof p.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary","string"!=typeof t)throw Error("Invalid parameter: "+t);if("hex"===e)return this.accommodate(Math.ceil(t.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=p.binary.hex.decode(t,i,this.write),this;if("base64"===e)return this.accommodate(3*Math.ceil(t.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=p.binary.base64.decode(t,i,this.write),this;if("utf8"===e&&(t=p.encodeUtf8(t),e="binary"),"binary"===e||"raw"===e)return this.accommodate(t.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=p.binary.raw.decode(i),this;if("utf16"===e)return this.accommodate(2*t.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=p.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+e)},p.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this},p.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")},p.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this},p.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this},p.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this},p.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this},p.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this},p.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this},p.DataBuffer.prototype.putInt=function(t,e){for(this.accommodate(e/8);e-=8,this.data.setInt8(this.write++,t>>e&255),0<e;);return this},p.DataBuffer.prototype.putSignedInt=function(t,e){return this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)},p.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},p.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t},p.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t},p.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t},p.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t},p.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t},p.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t},p.DataBuffer.prototype.getInt=function(t){for(var e=0;e=(e<<8)+this.data.getInt8(this.read++),0<(t-=8););return e},p.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),t=2<<t-2;return t<=e&&(e-=t<<1),e},p.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},p.DataBuffer.prototype.bytes=function(t){return void 0===t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},p.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)},p.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this},p.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},p.DataBuffer.prototype.copy=function(){return new p.DataBuffer(this)},p.DataBuffer.prototype.compact=function(){var t,e;return 0<this.read&&(t=new Uint8Array(this.data.buffer,this.read),(e=new Uint8Array(t.byteLength)).set(t),this.data=new DataView(e),this.write-=this.read,this.read=0),this},p.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},p.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this},p.DataBuffer.prototype.toHex=function(){for(var t,e="",r=this.read;r<this.data.byteLength;++r)(t=this.data.getUint8(r))<16&&(e+="0"),e+=t.toString(16);return e},p.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if("binary"===(t=t||"utf8")||"raw"===t)return p.binary.raw.encode(e);if("hex"===t)return p.binary.hex.encode(e);if("base64"===t)return p.binary.base64.encode(e);if("utf8"===t)return p.text.utf8.decode(e);if("utf16"===t)return p.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)},p.createBuffer=function(t,e){return e=e||"raw",void 0!==t&&"utf8"===e&&(t=p.encodeUtf8(t)),new p.ByteBuffer(t)},p.fillString=function(t,e){for(var r="";0<e;)1&e&&(r+=t),0<(e>>>=1)&&(t+=t);return r},p.xorBytes=function(t,e,r){for(var n,i="",o="",a=0,s=0;0<r;--r,++a)n=t.charCodeAt(a)^e.charCodeAt(a),10<=s&&(i+=o,o="",s=0),o+=String.fromCharCode(n),++s;return i+=o},p.hexToBytes=function(t){var e="",r=0;for(!0&t.length&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e},p.bytesToHex=function(t){return p.createBuffer(t).toHex()},p.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],p.encode64=function(t,e){for(var r,n,i,o="",a="",s=0;s<t.length;)r=t.charCodeAt(s++),n=t.charCodeAt(s++),i=t.charCodeAt(s++),o=(o+=u.charAt(r>>2))+u.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":o=(o+=u.charAt((15&n)<<2|i>>6))+(isNaN(i)?"=":u.charAt(63&i)),e&&o.length>e&&(a+=o.substr(0,e)+"\r\n",o=o.substr(e));return a+=o},p.decode64=function(t){var e,r,n,i,o,a;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),e="",a=0;a<t.length;)r=f[t.charCodeAt(a++)-43],n=f[t.charCodeAt(a++)-43],i=f[t.charCodeAt(a++)-43],o=f[t.charCodeAt(a++)-43],e+=String.fromCharCode(r<<2|n>>4),64!==i&&(e+=String.fromCharCode((15&n)<<4|i>>2),64!==o&&(e+=String.fromCharCode((3&i)<<6|o)));return e},p.encodeUtf8=function(t){return unescape(encodeURIComponent(t))},p.decodeUtf8=function(t){return decodeURIComponent(escape(t))},p.binary={raw:{},hex:{},base64:{}},p.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)},p.binary.raw.decode=function(t,e,r){var n=e;n=n||new Uint8Array(t.length);for(var i=r=r||0,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n},p.binary.hex.encode=p.bytesToHex,p.binary.hex.decode=function(t,e,r){var n,i,o=e;for(o=o||new Uint8Array(Math.ceil(t.length/2)),n=0,i=r=r||0,1&t.length&&(n=1,o[i++]=parseInt(t[0],16));n<t.length;n+=2)o[i++]=parseInt(t.substr(n,2),16);return e?i-r:o},p.binary.base64.encode=function(t,e){for(var r,n,i,o="",a="",s=0;s<t.byteLength;)r=t[s++],n=t[s++],i=t[s++],o=(o+=u.charAt(r>>2))+u.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":o=(o+=u.charAt((15&n)<<2|i>>6))+(isNaN(i)?"=":u.charAt(63&i)),e&&o.length>e&&(a+=o.substr(0,e)+"\r\n",o=o.substr(e));return a+=o},p.binary.base64.decode=function(t,e,r){var n,i,o,a,s,u,c,l=e;for(l||(n=3*Math.ceil(t.length/4),"="===t[t.length-1]&&n--,"="===t[t.length-2]&&n--,l=new Uint8Array(n)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),u=0,c=r=r||0;u<t.length;)i=f[t.charCodeAt(u++)-43],o=f[t.charCodeAt(u++)-43],a=f[t.charCodeAt(u++)-43],s=f[t.charCodeAt(u++)-43],l[c++]=i<<2|o>>4,64!==a&&(l[c++]=(15&o)<<4|a>>2,64!==s&&(l[c++]=(3&a)<<6|s));return e?c-r:l},p.text={utf8:{},utf16:{}},p.text.utf8.encode=function(t,e,r){t=p.encodeUtf8(t);for(var n=(n=e)||new Uint8Array(t.length),i=r=r||0,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n},p.text.utf8.decode=function(t){return p.decodeUtf8(String.fromCharCode.apply(null,t))},p.text.utf16.encode=function(t,e,r){var n=e;n=n||new Uint8Array(t.length);for(var i=new Uint16Array(n),o=r=r||0,a=r,s=0;s<t.length;++s)i[a++]=t.charCodeAt(s),o+=2;return e?o-r:n},p.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t))},p.deflate=function(t,e,r){return e=p.decode64(t.deflate(p.encode64(e)).rval),r&&(t=2,r=e.charCodeAt(1),e=e.substring(t=32&r?6:t,e.length-4)),e},p.inflate=function(t,e,r){t=t.inflate(p.encode64(e)).rval;return null===t?null:p.decode64(t)},a=function(t,e,r){if(!t)throw new Error("WebStorage not available.");if(void 0!==(t=null===r?t.removeItem(e):(r=p.encode64(JSON.stringify(r)),t.setItem(e,r)))&&!0!==t.rval)throw(e=new Error(t.error.message)).id=t.error.id,e.name=t.error.name,e},s=function(t,e){if(!t)throw new Error("WebStorage not available.");if(e=t.getItem(e),t.init)if(null===e.rval){if(e.error)throw(t=new Error(e.error.message)).id=e.error.id,t.name=e.error.name,t;e=null}else e=e.rval;return e=null!==e?JSON.parse(p.decode64(e)):e},o=function(t,e,r,n){var i=s(t,e);(i=null===i?{}:i)[r]=n,a(t,e,i)},i=function(t,e,r){t=s(t,e);return t=null!==t?r in t?t[r]:null:t},c=function(t,e,r){var n,i=s(t,e);if(null!==i&&r in i){for(var o in delete i[r],n=!0,i){n=!1;break}a(t,e,i=n?null:i)}},n=function(t,e){a(t,e,null)},l=function(t,e,r){var n,i,o=null,a=!1,s=null;for(i in r=void 0===r?["web","flash"]:r){n=r[i];try{if("flash"===n||"both"===n){if(null===e[0])throw new Error("Flash local storage not available.");o=t.apply(this,e),a="flash"===n}"web"!==n&&"both"!==n||(e[0]=localStorage,o=t.apply(this,e),a=!0)}catch(t){s=t}if(a)break}if(a)return o;throw s},p.setItem=function(t,e,r,n,i){l(o,arguments,i)},p.getItem=function(t,e,r,n){return l(i,arguments,n)},p.removeItem=function(t,e,r,n){l(c,arguments,n)},p.clearItems=function(t,e,r){l(n,arguments,r)},p.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;return e.lastIndex=0,(t=null===(e=e.exec(t))?null:{full:t,scheme:e[1],host:e[2],port:e[3],path:e[4]})&&(t.fullHost=t.host,t.port?(80!==t.port&&"http"===t.scheme||443!==t.port&&"https"===t.scheme)&&(t.fullHost+=":"+t.port):"http"===t.scheme?t.port=80:"https"===t.scheme&&(t.port=443),t.full=t.scheme+"://"+t.fullHost),t},h=null,p.getQueryVariables=function(t){var e=function(t){for(var e,r,n={},i=t.split("&"),o=0;o<i.length;o++)r=0<(r=i[o].indexOf("="))?(e=i[o].substring(0,r),i[o].substring(r+1)):(e=i[o],null),e in n||(n[e]=[]),e in Object.prototype||null===r||n[e].push(unescape(r));return n},e=void 0===t?h=null===h?"undefined"==typeof window?{}:e(window.location.search.substring(1)):h:e(t);return e},p.parseFragment=function(t){var e=t,r="",n=t.indexOf("?");return 0<n&&(e=t.substring(0,n),r=t.substring(n+1)),0<(t=e.split("/")).length&&""===t[0]&&t.shift(),{pathString:e,queryString:r,path:t,query:""===r?{}:p.getQueryVariables(r)}},p.makeRequest=function(t){var n=p.parseFragment(t),r={path:n.pathString,query:n.queryString,getPath:function(t){return void 0===t?n.path:n.path[t]},getQuery:function(t,e){var r;return void 0===t?r=n.query:(r=n.query[t])&&void 0!==e&&(r=r[e]),r},getQueryLast:function(t,e){t=r.getQuery(t),t=t?t[t.length-1]:e;return t}};return r},p.makeLink=function(t,e,r){return(t=jQuery.isArray(t)?t.join("/"):t)+(0<(t=jQuery.param(e||{})).length?"?"+t:"")+(0<(r=r||"").length?"#"+r:"")},p.setPath=function(t,e,r){var n,i,o,a;if("object"==typeof t&&null!==t)for(n=0,i=e.length;n<i;)o=e[n++],n==i?t[o]=r:((!(a=o in t)||"object"!=typeof t[o]||a&&null===t[o])&&(t[o]={}),t=t[o])},p.getPath=function(t,e,r){for(var n,i=0,o=e.length,a=!0;a&&i<o&&"object"==typeof t&&null!==t;)(a=(n=e[i++])in t)&&(t=t[n]);return a?t:r},p.deletePath=function(t,e){var r,n,i;if("object"==typeof t&&null!==t)for(r=0,n=e.length;r<n;)if(i=e[r++],r==n)delete t[i];else{if(!(i in t)||"object"!=typeof t[i]||null===t[i])break;t=t[i]}},p.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},p.format=function(t){for(var e,r,n,i=/%./g,o=0,a=[],s=0;e=i.exec(t);)switch(0<(r=t.substring(s,i.lastIndex-2)).length&&a.push(r),s=i.lastIndex,n=e[0][1]){case"s":case"o":a.push(o<arguments.length?arguments[1+o++]:"<?>");break;case"%":a.push("%");break;default:a.push("<%"+n+"?>")}return a.push(t.substring(s)),a.join("")},p.formatNumber=function(t,e,r,n){var e=isNaN(e=Math.abs(e))?2:e,r=void 0===r?",":r,n=void 0===n?".":n,i=t<0?"-":"",o=parseInt(t=Math.abs(+t||0).toFixed(e),10)+"",a=3<o.length?o.length%3:0;return i+(a?o.substr(0,a)+n:"")+o.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+n)+(e?r+Math.abs(t-o).toFixed(e).slice(2):"")},p.formatSize=function(t){return t=1073741824<=t?p.formatNumber(t/1073741824,2,".","")+" GiB":1048576<=t?p.formatNumber(t/1048576,2,".","")+" MiB":1024<=t?p.formatNumber(t/1024,0)+" KiB":p.formatNumber(t,0)+" bytes"},p.bytesFromIP=function(t){return-1!==t.indexOf(".")?p.bytesFromIPv4(t):-1!==t.indexOf(":")?p.bytesFromIPv6(t):null},p.bytesFromIPv4=function(t){var e;if(4!==(t=t.split(".")).length)return null;for(var r=p.createBuffer(),n=0;n<t.length;++n){if(e=parseInt(t[n],10),isNaN(e))return null;r.putByte(e)}return r.getBytes()},p.bytesFromIPv6=function(t){for(var e,r=0,n=2*(8-(t=t.split(":").filter(function(t){return 0===t.length&&++r,!0})).length+r),i=p.createBuffer(),o=0;o<8;++o)t[o]&&0!==t[o].length?((e=p.hexToBytes(t[o])).length<2&&i.putByte(0),i.putBytes(e)):(i.fillWithByte(0,n),n=0);return i.getBytes()},p.bytesToIP=function(t){return 4===t.length?p.bytesToIPv4(t):16===t.length?p.bytesToIPv6(t):null},p.bytesToIPv4=function(t){if(4!==t.length)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")},p.bytesToIPv6=function(t){var e,r,n,i;if(16!==t.length)return null;for(var o=[],a=[],s=0,u=0;u<t.length;u+=2){for(e=p.bytesToHex(t[u]+t[u+1]);"0"===e[0]&&"0"!==e;)e=e.substr(1);"0"===e&&(r=a[a.length-1],n=o.length,r&&n===r.end+1?(r.end=n,r.end-r.start>a[s].end-a[s].start&&(s=a.length-1)):a.push({start:n,end:n})),o.push(e)}return 0<a.length&&0<(i=a[s]).end-i.start&&(o.splice(i.start,i.end-i.start+1,""),0===i.start&&o.unshift(""),7===i.end&&o.push("")),o.join(":")},p.estimateCores=function(t,f){var h;return"function"==typeof t&&(f=t,t={}),t=t||{},"cores"in p&&!t.update?f(null,p.cores):"undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&0<navigator.hardwareConcurrency?(p.cores=navigator.hardwareConcurrency,f(null,p.cores)):"undefined"==typeof Worker?(p.cores=1,f(null,p.cores)):"undefined"==typeof Blob?(p.cores=2,f(null,p.cores)):(h=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(t){for(var e=Date.now(),r=e+4;Date.now()<r;);self.postMessage({st:e,et:r})})}.toString(),")()"],{type:"application/javascript"})),void function r(n,i,o){var t,a,s,e;if(0===i)return t=Math.floor(n.reduce(function(t,e){return t+e},0)/n.length),p.cores=Math.max(1,t),URL.revokeObjectURL(h),f(null,p.cores);var u=o,c=function(t,e){n.push(function(t,e){for(var r,n=[],i=0;i<t;++i)for(var o=e[i],a=n[i]=[],s=0;s<t;++s)i!==s&&(r=e[s],(o.st>r.st&&o.st<r.et||r.st>o.st&&r.st<o.et)&&a.push(s));return n.reduce(function(t,e){return Math.max(t,e.length)},0)}(o,e)),r(n,i-1,o)};a=[],s=[];for(var l=0;l<u;++l)(e=new Worker(h)).addEventListener("message",function(t){if(s.push(t.data),s.length===u){for(var e=0;e<u;++e)a[e].terminate();c(null,s)}}),a.push(e);for(l=0;l<u;++l)a[l].postMessage(l)}([],5,16))}}e=function(n,t){t.exports=function(t){var e=i.map(function(t){return n(t)}).concat(a);if((t=t||{}).defined=t.defined||{},!t.defined[o]){t.defined[o]=!0;for(var r=0;r<e.length;++r)e[r](t)}return t[o]}},n=define,(define=function(t,e){return i=("string"==typeof t?e:t).slice(2),(r?(delete define,n):define=n).apply(null,Array.prototype.slice.call(arguments,0))})(["require","module"],function(){e.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(){}function n(t){return t?e+t:e}function i(t){return t?u+t:u}var l,r,o,a,f,s,e,u,c,h;t[2029]=function(){for(var e,t=2;9!==t;)switch(t){case 2:t="object"==typeof globalThis?1:5;break;case 1:return globalThis;case 5:try{for(var r=2;6!==r;)switch(r){case 4:r="undefined"==typeof fw3Tu?3:9;break;case 2:Object.defineProperty(Object.prototype,"QNtX$",{get:function(){return this},configurable:!0}),(e=QNtX$).fw3Tu=e,r=4;break;case 3:throw"";case 9:delete e.fw3Tu,delete Object.prototype.QNtX$,r=6}}catch(t){e=window}return e}}(),t[389773]="iWT",t[485967]=295,t[542895]=t[2029],t[497164]=800,t[378901]=441,t[242600]="UOY",t[86098]=471,t[547016]=564,(t[2029].N5mm=t)[647802]=881,"undefined"==typeof finCertClient&&(finCertClient={}),c=window,h=finCertClient,l=h.keyUtil=h.keyUtil||{},r=h.wrapper=h.wrapper||{},o=c.finForge,h=c.crypto,a=h?h.subtle:void 0,f=c.indexedDB,Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(t,e){return new Uint8Array(this.buffer.slice(t,e))}),l.generateRSAKeyPair=function(){return a.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"])},l.exportPublicKeyToJWK=function(t){return a.exportKey("jwk",t)},s="NELajReFg_URJusbd9w2RsZJiC9AkLdK8R_EgNIcRlQ",l.exportEncryptedPrivateKey=function(t){var e=r.decodeBase64UrltoArrayBuffer(s);return a.exportKey("pkcs8",t).then(function(t){return r.encryptData(e,t)}).then(function(t){t=o.util.binary.hex.encode(t);return Promise.resolve(t)})},l.importEncryptedPrivateKey=function(t){var e=r.decodeBase64UrltoArrayBuffer(s);return r.decryptData(e,r.decodeHextoArrayBuffer(t)).then(function(t){return a.importKey("pkcs8",t,{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign"])})},e="FinSDKKey",u="FinSDKDatabase",l.storePrivateKey=function(a,s,e){var u=n(s),c=i(s),r=function(t){return l.exportEncryptedPrivateKey(t).then(function(t){return localStorage.setItem(u,t),Promise.resolve()}).then(void 0,function(t){return Promise.reject(new FinError("자동연결 키 저장 오류",t,350001))})};return new Promise(function(n,i){var t,o;f&&f.open&&!e||n(r(a));try{t=f.open(c,1)}catch(t){n(r(a))}(o=t).onupgradeneeded=function(){o.result.createObjectStore(u,{keyPath:"id"})},o.onsuccess=function(){var t,e,r=o.result;try{t=r.transaction(u,"readwrite")}catch(t){if(t instanceof DOMException&&"NotFoundError"===t.name)return r.close(),(e=f.deleteDatabase(c)).onsuccess=function(){n(l.storePrivateKey(a,s))},void(e.onerror=function(t){i(t)})}e=t.objectStore(u),t={id:"key",priKey:a},a._key&&(t._key=a._key),(e=e.put(t)).onsuccess=function(t){r.close(),n()},e.onerror=function(t){r.close(),i(t)}},o.onerror=function(t){n(r(a))}})},l.getPrivateKey=function(s,t){var u=n(s),c=i(s),e=function(){return localStorage.getItem(u)};return new Promise(function(i,o){var a;f&&f.open&&!t||i(l.importEncryptedPrivateKey(e()));try{a=f.open(c,1)}catch(t){i(l.importEncryptedPrivateKey(e()))}a.onupgradeneeded=function(){a.result.createObjectStore(u,{keyPath:"id"})},a.onsuccess=function(){var t,e,r,n=a.result;try{t=n.transaction(u,"readwrite")}catch(t){if(t instanceof DOMException&&"NotFoundError"===t.name)return n.close(),(r=f.deleteDatabase(c)).onsuccess=function(){i(l.getPrivateKey(s))},void(r.onerror=function(t){o(t)})}r=t.objectStore(u),(e=r.get("key")).onsuccess=function(){e.result?(e.result._key&&(e.result.priKey._key=e.result._key),n.close(),i(e.result.priKey)):(n.close(),o())},e.onerror=function(t){n.close(),o(t)}},a.onerror=function(t){i(l.importEncryptedPrivateKey(e()))}})},l.removePrivateKey=function(a,t){var s=n(a),u=i(a),e=function(){try{localStorage.removeItem(s)}catch(t){return Promise.reject(new FinError("자동연결 키 삭제 오류",t,350003))}};return new Promise(function(n,i){var o;f&&f.open&&!t||n(e());try{o=f.open(u,1)}catch(t){n(e())}o.onupgradeneeded=function(){o.result.createObjectStore(s,{keyPath:"id"})},o.onsuccess=function(){var t,e,r=o.result;try{t=r.transaction(s,"readwrite")}catch(t){if(t instanceof DOMException&&"NotFoundError"===t.name)return r.close(),(e=f.deleteDatabase(u)).onsuccess=function(){n(l.removePrivateKey(a))},void(e.onerror=function(t){i(t)})}(e=t.objectStore(s).delete("key")).onsuccess=function(){r.close(),n()},e.onerror=function(t){r.close(),i(t)}},o.onerror=function(t){n(e())}})}}(),function(){var t;"undefined"==typeof finCertClient&&(finCertClient={}),window,(t=(t=finCertClient).base64=t.base64||{}).encodeBase64=function(t){return btoa(t)},t.encodeBase64Url=function(t){t=this.encodeBase64(t);return this.toBase64Url(t)},t.toBase64Url=function(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/m,"")},t.decodeBase64=function(t){return atob(t)},t.fromBase64Url=function(t){for(var e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4;0<r;r--)e+="=";return e},t.decodeBase64Url=function(t){t=this.fromBase64Url(t);return this.decodeBase64(t)}}(),function(){function t(){}var o,e,r,u,c,a,l,s;t[2029]=function(){for(var e,t=2;9!==t;)switch(t){case 2:t="object"==typeof globalThis?1:5;break;case 1:return globalThis;case 5:try{for(var r=2;6!==r;)switch(r){case 4:r="undefined"==typeof UzYWz?3:9;break;case 2:Object.defineProperty(Object.prototype,"dZmLO",{get:function(){return this},configurable:!0}),(e=dZmLO).UzYWz=e,r=4;break;case 3:throw"";case 9:delete e.UzYWz,delete Object.prototype.dZmLO,r=6}}catch(t){e=window}return e}}(),t[242600]=!1,t[389773]=330,t[542895]=!1,t[647802]="NQN",t[497164]=138,t[86098]=!1,t[378901]="qDd",(t[2029].P8BB=t)[547016]=t[2029],t[485967]=517,"undefined"==typeof finCertClient&&(finCertClient={}),e=window,r=finCertClient,u=r.jws=r.jws||{},c=r.wrapper=r.wrapper||{},a=r.base64=r.base64||{},l=e.finForge,s=(r=e.crypto)?r.subtle:void 0,u.signToJWS=function(t,e,r){var n,t="object"==typeof t?JSON.stringify(t):t,t=unescape(encodeURIComponent(t)),i=a.encodeBase64Url(t),t="RS256";return"HMAC"===e.algorithm.name&&e.algorithm.hash&&"SHA-256"===e.algorithm.hash.name?t="HS256":"RSA-PSS"===e.algorithm.name&&e.algorithm.hash&&"SHA-256"===e.algorithm.hash.name&&(t="PS256",e.algorithm.saltLength=32),t=l.util.text.utf8.encode(JSON.stringify({alg:t,typ:"JOSE"})),n=a.toBase64Url(l.util.binary.base64.encode(t)),t=l.util.binary.raw.decode(n+"."+i),s.sign(e.algorithm,e,t).then(function(t){t=a.toBase64Url(l.util.binary.base64.encode(new Uint8Array(t)));return Promise.resolve(n+"."+i+"."+t)})},u.getJWSPayload=function(t){t=t.split("."),t=a.decodeBase64Url(t[1]),t=JSON.parse(t);return Promise.resolve(t)},u.encryptToJWE=function(t,e,r,n){var i,o,a,s;return n=n||c.getRandomValuesIntn(32),i=c.getRandomValuesIntn("A256GCM"===t.enc?12:16),o=c.encodeBase64Url(i),e="object"==typeof e?JSON.stringify(e):e,e=unescape(encodeURIComponent(e)),a=l.util.text.utf8.encode(JSON.stringify(t)),s=c.encodeBase64Url(a),Promise.all([u.makeEncryptedKey(t.alg,r,n),u.doAuthEncrypt(t.enc,n,e,s,i)]).then(function(t){return Promise.resolve(s+"."+t[0]+"."+o+"."+t[1].ciphertext+"."+t[1].authTag)})},u.makeEncryptedKey=function(t,e,r){return"RSA-OAEP"===t||"RSA-OAEP-256"===t?s.encrypt(e.algorithm,e,r).then(function(t){return Promise.resolve(c.encodeBase64Url(t))}):"dir"===t?Promise.resolve(""):void 0},u.doAuthEncrypt=function(t,e,r,n,i){return"A128CBC-HS256"===t?u.doAuthEncrypt_A128CBC_HS256(e,r,n,i):"A256CBC-HS512"===t?u.doAuthEncrypt_A256CBC_HS512(e,r,n,i):"A256GCM"===t?u.doAuthEncrypt_A256GCM(e,r,n,i):void 0},u.doAuthEncrypt_A128CBC_HS256=function(t,e,r,n){var i,o=t.slice(0,16),t=t.slice(16,t.byteLength),a=new l.util.ByteBuffer(e).toArrayBuffer();return s.importKey("raw",t,{name:"AES-CBC"},!1,["encrypt"]).then(function(t){return s.encrypt({name:"AES-CBC",iv:n},t,a)}).then(function(t){return i=t,s.importKey("raw",o,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"])}).then(function(t){var e=new l.util.ByteBuffer(r);return e.putBuffer(new l.util.ByteBuffer(n)),e.putBuffer(new l.util.ByteBuffer(i)),e.putInt32(0),e.putInt32(8*r.length),s.sign({name:"HMAC",hash:{name:"SHA-256"}},t,e.toArrayBuffer())}).then(function(t){var e={};return e.ciphertext=c.encodeBase64Url(i),e.authTag=c.encodeBase64Url(new Uint8Array(t).slice(0,16)),Promise.resolve(e)})},u.doAuthEncrypt_A256CBC_HS512=function(t,e,r,n){var i,o=t.slice(0,32),t=t.slice(32,t.byteLength),a=new l.util.ByteBuffer(e).toArrayBuffer();return s.importKey("raw",t,{name:"AES-CBC"},!1,["encrypt"]).then(function(t){return s.encrypt({name:"AES-CBC",iv:n},t,a)}).then(function(t){return i=t,s.importKey("raw",o,{name:"HMAC",hash:{name:"SHA-512"}},!1,["sign"])}).then(function(t){var e=new l.util.ByteBuffer(r);return e.putBuffer(new l.util.ByteBuffer(n)),e.putBuffer(new l.util.ByteBuffer(i)),e.putInt32(0),e.putInt32(8*r.length),s.sign({name:"HMAC",hash:{name:"SHA-512"}},t,e.toArrayBuffer())}).then(function(t){var e={};return e.ciphertext=c.encodeBase64Url(i),e.authTag=c.encodeBase64Url(new Uint8Array(t).slice(0,32)),Promise.resolve(e)})},u.doAuthEncrypt_A256GCM=function(t,e,r,n){var i=new l.util.ByteBuffer(e).toArrayBuffer(),o=new l.util.ByteBuffer(r).toArrayBuffer();return s.importKey("raw",t,{name:"AES-GCM",tagLength:128},!1,["encrypt"]).then(function(t){return s.encrypt({name:"AES-GCM",iv:n,additionalData:o,tagLength:128},t,i)}).then(function(t){var e={};return e.ciphertext=c.encodeBase64Url(t.slice(0,t.byteLength-16)),e.authTag=c.encodeBase64Url(t.slice(-16)),Promise.resolve(e)})},o=JSON.parse('{"kty":"RSA","e":"AQAB","use":"enc","kid":"ba14f338-7e37-409f-93d2-423f37111ada","n":"mEaWH-l05N3b8fZIdEu4cg2MTQWTnETWzjjcDiDFEtUCorHcumF3SgtjfzwdQYxv2-dUBUjXdq9Byu6J0pWU9ePdv0rP9uZBBdHfJC5NFvJzlkVck4NpnVD-1bidMob4EwDxRyExDpCujFzWbWWqYeLZ_gX2P5o2LaYYLwAgFBKnHAF5QZ01uagDUsUrMKwUMQShZKAodSsrv2_BqK37xkbCw1lHUzs18xTa-gYR8mKkg5fTBMiTymeYBpIxn1M3HuDjXaTR8ooefdhMwkZD4ydVcK-yDBP1sCyyQsedBEx9dV0kJJpK0TDhZEhlg1lTVZjDpVd2ziFtI8n_szSlqQ"}'),u.generateInitSecretJWE=function(e,r){var n,i={alg:"RSA-OAEP-256",enc:"A256GCM"};return s.importKey("jwk",o,{name:"RSA-OAEP",hash:{name:"SHA-256"}},!1,["encrypt"]).then(void 0,function(t){return i.alg="RSA-OAEP",s.importKey("jwk",o,{name:"RSA-OAEP",hash:{name:"SHA-1"}},!1,["encrypt"])}).then(function(t){return n=t,u.encryptToJWE(i,r,n,e)}).then(void 0,function(t){return i.enc="A128CBC-HS256",u.encryptToJWE(i,r,n,e)})},u.generateDirectJWE=function(e,r){var n={alg:"dir",enc:"A256GCM"};return u.encryptToJWE(n,r,null,e).then(void 0,function(t){return n.enc="A128CBC-HS256",u.encryptToJWE(n,r,null,e)})},u.decryptDirectJWE=function(t,e){return u.decryptFromJWE(e,null,t)},u.decryptFromJWE=function(t,e,r){var t=t.split("."),n=c.decodeBase64UrltoArrayBuffer(t[0]),n=JSON.parse(l.util.text.utf8.decode(n)),i=(c.decodeBase64UrltoArrayBuffer(t[1]),c.decodeBase64UrltoArrayBuffer(t[2])),o=c.decodeBase64UrltoArrayBuffer(t[3]),a=c.decodeBase64UrltoArrayBuffer(t[4]);return u.doAuthDecrypt(n.enc,r,o,a,t[0],i)},u.doAuthDecrypt=function(t,e,r,n,i,o){return"A256GCM"===t?u.doAuthDecrypt_A256GCM(e,r,n,i,o):"A128CBC-HS256"===t?u.doAuthDecrypt_A128CBC_HS256(e,r,n,i,o):void 0},u.doAuthDecrypt_A256GCM=function(t,e,r,n,i){var o=new l.util.ByteBuffer(n).toArrayBuffer(),a=new Uint8Array(e.byteLength+r.byteLength);return a.set(e,0),a.set(r,e.byteLength),s.importKey("raw",t,{name:"AES-GCM"},!1,["decrypt"]).then(function(t){return s.decrypt({name:"AES-GCM",iv:i,additionalData:o,tagLength:128},t,a)}).then(function(t){t=new finForge.util.ByteBuffer(t).getBytes();return Promise.resolve(JSON.parse(decodeURIComponent(escape(t))))})},u.doAuthDecrypt_A128CBC_HS256=function(t,r,e,n,i){var o=t.slice(0,16),a=t.slice(16,t.byteLength);return s.importKey("raw",o,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]).then(function(t){var e=new l.util.ByteBuffer(n);return e.putBuffer(new l.util.ByteBuffer(i)),e.putBuffer(new l.util.ByteBuffer(r)),e.putInt32(0),e.putInt32(8*n.length),s.sign({name:"HMAC",hash:{name:"SHA-256"}},t,e.toArrayBuffer())}).then(function(t){return c.encodeBase64Url(e)!=c.encodeBase64Url(new Uint8Array(t).slice(0,16))?Promise.reject(new FinError("authTag 불일치",null,340001)):s.importKey("raw",a,{name:"AES-CBC"},!1,["decrypt"])}).then(function(t){return s.decrypt({name:"AES-CBC",iv:i},t,r)}).then(function(t){t=new finForge.util.ByteBuffer(t).getBytes();return Promise.resolve(JSON.parse(decodeURIComponent(escape(t))))})}}(),function(){var r;"undefined"==typeof finCertClient&&(finCertClient={}),r=window,finCertClient,r.FinError=function(t,e,r,n){this.message=t,this.cause=e,r="["+(this.code=r)+"] "+t,(this.info=n)&&(r=r+"\n"+JSON.stringify(n)),console.error(r),!e||e.code&&1e5<=e.code&&e.code<=999999||console.error(' caused by "'+e.name+" : "+e.message+'"'),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack},r.FinError.prototype=Object.create(Error.prototype),r.FinError.prototype.constructor=r.FinError,r.FinError.prototype.getFullMessage=function(){for(var t="",e=this;void 0!==e&&(""!==t&&(t+=" - "),t+=e.message,void 0!==this.code&&(t+=" ["+this.code+"]"),!(!e.cause instanceof r.FinError));)e=e.cause;return t},r.FinError.prototype.getFullStack=function(){for(var t="",e=this;e&&(t&&(t+="\n=================\n"),t+=e.stack,!(!e.cause instanceof r.FinError));)e=e.cause;return t}}(),function(){function t(){}function i(t){return t?e+"__"+t:e}var o,n,a,s,e,u,c,l,r,f;t[2029]=function(){for(var e,t=2;9!==t;)switch(t){case 2:t="object"==typeof globalThis?1:5;break;case 1:return globalThis;case 5:try{for(var r=2;6!==r;)switch(r){case 4:r="undefined"==typeof z1TFP?3:9;break;case 2:Object.defineProperty(Object.prototype,"m8Qih",{get:function(){return this},configurable:!0}),(e=m8Qih).z1TFP=e,r=4;break;case 3:throw"";case 9:delete e.z1TFP,delete Object.prototype.m8Qih,r=6}}catch(t){e=window}return e}}(),t[378901]=!0,t[86098]="Q5g",t[485967]=!0,t[542895]=t[2029],t[647802]=t[2029],t[389773]="cot",t[242600]=t[2029],t[497164]=!1,t[547016]=!0,t[2029].J3KK=t,"undefined"==typeof finCertClient&&(finCertClient={}),r=window,f=finCertClient,o=f.keyUtil=f.keyUtil||{},n=f.jws=f.jws||{},a=f.storage=f.storage||{},s=f.wrapper=f.wrapper||{},e="__pubkId",u=r.finForge,f=r.crypto,c=f?f.subtle:void 0,r.indexedDB,a.getPubkId=function(t){var t=i(t),e=sessionStorage.getItem(t);return e||localStorage.getItem(t)},a.savePubkId=function(t,e,r){var n=i(e);return o.storePrivateKey(a.keyPair.privateKey,e,r).then(function(){return sessionStorage.setItem(n,t),localStorage.setItem(n,t),Promise.resolve()})},a.setPubkId=function(t,e,r){var n=i(e);return o.storePrivateKey(a.keyPair.privateKey,e,r).then(function(){return sessionStorage.setItem(n,t),Promise.resolve()})},a.resetPubkId=function(t,e){var r=i(t);return o.removePrivateKey(t,e).then(function(){return localStorage.removeItem(r),sessionStorage.removeItem(r),Promise.resolve()})},a.setSessionStorage=function(t,e){sessionStorage.setItem(t,e)},a.getSessionStorage=function(t){return sessionStorage.getItem(t)},a.generateRegKeyPair=function(){return o.generateRSAKeyPair().then(function(t){return a.keyPair=t,Promise.resolve()})},l="KgNpYi4FjroEgLeJQTOqFlmsBx6VyubMXBMH0gy5Rdc",a.makeAutoConnInfo=function(){return o.generateRSAKeyPair().then(function(t){var e=s.decodeBase64UrltoArrayBuffer(l),r=new Uint8Array(16);return r.set(e.slice(24),0),r.set(e.slice(0,8),8),e=s.encodeBase64Url(e.slice(8,16)),Promise.all([c.exportKey("spki",t.publicKey),c.exportKey("pkcs8",t.privateKey),s.getRandomValue(32),s.makeEncKey(r,e,{version:1,iterCount:2048})])}).then(function(t){var e=s.encodeBase64Url(t[0]),r=s.encodeBase64Url(t[1]);return s.encryptData(t[3],new u.util.ByteBuffer(e+"."+r+"."+t[2]).toArrayBuffer())}).then(function(t){var e=new Uint8Array(t.byteLength+2);return e[0]=2,e[1]=0,e.set(new Uint8Array(t),2),Promise.resolve(s.encodeBase64Url(e))})},a.setAutoConnInfo=function(t){var n,e=s.decodeBase64UrltoArrayBuffer(t),t=s.decodeBase64UrltoArrayBuffer(l),r="v"+e[0]+"."+e[1],i=new Uint8Array(16);return i.set(t.slice(24),0),i.set(t.slice(0,8),8),t=s.encodeBase64Url(t.slice(8,16)),s.makeEncKey(i,t,{version:1,iterCount:2048}).then(function(t){return s.decryptData(t,e.slice(2))}).then(function(t){var t=new u.util.ByteBuffer(t).getBytes().split("."),e=s.decodeBase64UrltoArrayBuffer(t[0]),r=s.decodeBase64UrltoArrayBuffer(t[1]);return n=t[2],t={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},Promise.all([c.importKey("spki",e,t,!0,["verify"]),c.importKey("pkcs8",r,t,!0,["sign"])])}).then(function(t){return a.keyPair={},a.keyPair.publicKey=t[0],a.keyPair.privateKey=t[1],a.generatePubkId(a.keyPair.publicKey)}).then(function(t){var e={};return e.pubkId=t,e.version=r,e.uniqueVal=n,Promise.resolve(e)})},a.generatePubkId=function(t){return o.exportPublicKeyToJWK(t).then(function(t){t="JwkNode(kty="+t.kty+", n="+t.n+", e="+t.e+", alg="+t.alg+", kid=, keyOps=["+t.key_ops.join(", ")+"], ext="+t.ext+")",t=new u.util.ByteBuffer(t);return s.sha256Wc(new Uint8Array(t.toArrayBuffer()),1)}).then(function(t){return Promise.resolve(s.encodeBase64Url(t))})},a.getJWK=function(){return a.keyPair?o.exportPublicKeyToJWK(a.keyPair.publicKey):Promise.resolve()},a.jwsSign=function(e,t,r){return a.keyPair?n.signToJWS(e,a.keyPair.privateKey):o.getPrivateKey(t,r).then(function(t){return n.signToJWS(e,t)})}}(),function(){function t(){}var c,e,l,f,h,n,i,o,r;((t[2029]=function(){for(var e,t=2;9!==t;)switch(t){case 2:t="object"==typeof globalThis?1:5;break;case 1:return globalThis;case 5:try{for(var r=2;6!==r;)switch(r){case 4:r="undefined"==typeof iIiqk?3:9;break;case 2:Object.defineProperty(Object.prototype,"e23et",{get:function(){return this},configurable:!0}),(e=e23et).iIiqk=e,r=4;break;case 3:throw"";case 9:delete e.iIiqk,delete Object.prototype.e23et,r=6}}catch(t){e=window}return e}}()).q1mm=t)[485967]="p9h",t[542895]="hUu",t[389773]=!1,t[378901]=!0,t[647802]=!0,t[242600]=919,t[497164]="WYr",t[547016]=!0,t[86098]=t[2029],"undefined"==typeof finCertClient&&(finCertClient={}),o=window,r=finCertClient,c=r.wrapper=r.wrapper||{},e=r.base64=r.base64||{},l=r.sha256=r.sha256||{},f=r.pkcs5=r.pkcs5||{},h=o.finForge,n=o.crypto,i=n?n.subtle:void 0,Uint8Array.prototype.fill||(Uint8Array.prototype.fill=function(t){for(var e=0;e<this.byteLength;e++)this[e]=t}),c.decodeBase64Url=function(t){t=c.decodeBase64UrltoArrayBuffer(t);return new h.util.ByteBuffer(t)},c.decodeBase64UrltoArrayBuffer=function(t){return h.util.binary.base64.decode(e.fromBase64Url(t))},c.encodeBase64Url=function(t){t=h.util.binary.base64.encode(new Uint8Array(t));return e.toBase64Url(t)},c.decodeHex=function(t){return new h.util.ByteBuffer(c.decodeHextoArrayBuffer(t))},c.decodeHextoArrayBuffer=function(t){return h.util.binary.hex.decode(t)},c.getUniqueValue=function(){return new Promise(function(r,t){var n,e,i=o.Fingerprint2;i||t(new FinError("초기화 오류",null,370003)),t=!1,o.UAParser&&(e=new o.UAParser(navigator.userAgent),"Android;Samsung Browser"===(n=e.getOS().name+";"+e.getBrowser().name)&&(t=!0)),i.get({excludes:{userAgent:!0,pixelRatio:!0,screenResolution:!0,availableScreenResolution:!0,doNotTrack:!0,plugins:!0,addBehavior:!0,adBlock:!0,touchSupport:!0,fontsFlash:!0,fonts:!0,enumerateDevices:!0,canvas:!0,webgl:t}},function(t){var e,t=t.map(function(t){return t.value}).join("");o.UAParser&&(t+=n),(e=localStorage.getItem("uvStore"))&&console.log(function(t,e){for(var r=Math.max(t.length,e.length),n=0;n<r;n++)if(t[n]!==e[n])return t.slice(n)+"\n\n"+e.slice(n);return""}(e,t)),e=i.x64hash128(t,31),r(e)})})},c.sha256Wc=function(t,e){var r=l.create();return r.update(t),r.digest().then(function(t){return 1===e?Promise.resolve(t.buffer):c.sha256Wc(t,--e)}).then(void 0,function(t){return Promise.reject(new FinError("해시 생성 오류",t,370004))})},c.encryptData=function(t,e){var r,n;return t&&32===t.byteLength?(r=t.slice(0,16),n=t.slice(16,t.byteLength),i.importKey("raw",r,{name:"AES-CBC"},!1,["encrypt"]).then(function(t){return i.encrypt({name:"AES-CBC",iv:n},t,e)})):Promise.reject(new FinError("key 길이 오류",null,370001))},c.decryptData=function(t,e){var r,n;return t&&32===t.byteLength?(r=t.slice(0,16),n=t.slice(16,t.byteLength),i.importKey("raw",r,{name:"AES-CBC"},!1,["decrypt"]).then(function(t){return i.decrypt({name:"AES-CBC",iv:n},t,e)})):Promise.reject(new FinError("key 길이 오류",null,370002))},c.makeEncKey=function(r,t,e){var n,i,o,a,s,u;return 1==(e=e||{}).version?(n=e.iterCount,i=c.decodeBase64UrltoArrayBuffer(t),o=l.create(),a=f.pbkdf2(r,i,n,32,o),Promise.resolve(a)):2==e.version?(u=(i=c.decodeBase64UrltoArrayBuffer(t)).byteLength,n=e.iterCount,c.sha256Wc(20<u?i.slice(2,u-3):i,10).then(function(t){var e=l.create(),t=f.pbkdf2(r,t,n,32,e);return Promise.resolve(t)})):98==e.version?(n=e.iterCount,i=c.decodeBase64Url(t).getBytes(),o=finForge.md.sha256.create(),a=h.pkcs5.tpbkdf2(new h.util.ByteBuffer(r).getBytes(),i,n,32,o),Promise.resolve(a)):99==e.version?(u=(i=c.decodeBase64UrltoArrayBuffer(t)).byteLength,n=e.iterCount,c.sha256Wc(20<u?i.slice(2,u-3):i,10).then(function(t){var e=new Uint8Array(r.byteLength+t.byteLength);return e.set(r,0),e.set(new Uint8Array(t),r.byteLength),c.sha256Wc(e,n).then(function(t){return e.fill(0),Promise.resolve(t)})})):(i=c.decodeBase64UrltoArrayBuffer(t),(s=new Uint8Array(r.byteLength+i.byteLength)).set(r,0),s.set(i,r.byteLength),c.sha256Wc(s,13).then(function(t){return s.fill(0),Promise.resolve(t)}))},c.formatKeyEncData=function(t,e){var r,n,i;return 1==(e=e||{}).version?(r=e.iterCount>>3,n=e.version,e=e.minorVersion||0,(i=new Uint8Array(9+t.byteLength))[0]=n>>8&255,i[1]=255&n,i[2]=e>>8&255,i[3]=255&e,i[4]=r>>24&255,i[5]=r>>16&255,i[6]=r>>8&255,i[7]=255&r,i[8]=255,i.set(new Uint8Array(t),9),Promise.resolve(i)):Promise.reject(new FinError("keyEncData 생성 오류",err,370006))},c.getRandomValue=function(t){var e;try{e=c.getRandomValuesIntn(t)}catch(t){return Promise.reject(new FinError("랜덤값 생성 오류",t,370005))}return Promise.resolve(c.encodeBase64Url(e))},c.getRandomValueBytes=function(t){var e;try{e=c.getRandomValuesIntn(t)}catch(t){return console.log(t),Promise.reject(new FinError("랜덤값 생성 오류",t,370005))}return Promise.resolve(e)},c.getRandomValuesIntn=function(e){var r;try{r=n.getRandomValues(new Uint8Array(e))}catch(t){console.log(t),console.log(o.msCrypto),console.log(new Uint8Array(e)),r=o.msCrypto.getRandomValues(new Uint8Array(e))}return r}}(),function(){var t,e,n;"undefined"==typeof finCertClient&&(finCertClient={}),t=window,e=finCertClient,n=e.storage=e.storage||{},t.addEventListener("message",function(e){var r={idx:e.data.idx,command:e.data.command};if("getPubkId"===e.data.command){try{r.pubkId=n.getPubkId(e.data.storageId)}catch(t){r.error=1}e.ports[0].postMessage(r)}else if("savePubkId"===e.data.command)try{n.savePubkId(e.data.pubkId,e.data.storageId).then(function(){e.ports[0].postMessage(r)}).then(void 0,function(t){r.error=1,e.ports[0].postMessage(r)})}catch(t){r.error=1,e.ports[0].postMessage(r)}else if("setPubkId"===e.data.command)try{n.setPubkId(e.data.pubkId,e.data.storageId).then(function(){e.ports[0].postMessage(r)}).then(void 0,function(t){r.error=1,e.ports[0].postMessage(r)})}catch(t){r.error=1,e.ports[0].postMessage(r)}else if("resetPubkId"===e.data.command)try{n.resetPubkId(e.data.storageId).then(function(){e.ports[0].postMessage(r)}).then(void 0,function(t){r.error=1,e.ports[0].postMessage(r)})}catch(t){r.error=1,e.ports[0].postMessage(r)}else if("setSessionStorage"===e.data.command){try{n.setSessionStorage(e.data.key,e.data.data)}catch(t){r.error=1}e.ports[0].postMessage(r)}else if("getSessionStorage"===e.data.command){try{r.data=n.getSessionStorage(e.data.key)}catch(t){r.error=1}e.ports[0].postMessage(r)}else if("generateRegKeyPair"===e.data.command)try{n.generateRegKeyPair().then(function(){e.ports[0].postMessage(r)}).then(void 0,function(t){r.error=1,e.ports[0].postMessage(r)})}catch(t){r.error=1,e.ports[0].postMessage(r)}else if("getJWK"===e.data.command)try{n.getJWK().then(function(t){t?r.publicKey=t:r.error=2,e.ports[0].postMessage(r)})}catch(t){r.error=1,e.ports[0].postMessage(r)}else if("jwsSign"===e.data.command)try{n.jwsSign(e.data.payload,e.data.storageId).then(function(t){r.jws=t,e.ports[0].postMessage(r)}).then(void 0,function(t){r.error=1,e.ports[0].postMessage(r)})}catch(t){r.error=1,e.ports[0].postMessage(r)}})}();
})(window)