!function(e,t,n){"use strict";function i(e){e.keystrokeEncryption?yt.webToken.SecKeyVendor=e.keystrokeEncryption:yt.webToken.SecKeyVendor="null",u(e.servicePort),"undefined"!=typeof e.language&&d(X[e.language]),"undefined"!=typeof e.replayAttack&&f(e.replayAttack),V.vestCert=e.vestCert,V.imgUrl=e.imgUrl}function o(){var e=parent.document.createElement("div");e.id="yettie_library_loading",e.style.position="fixed",e.style.left="0",e.style.right="0",e.style.top=document.documentElement.clientHeight/2+"px",e.style.bottom="0",e.style.marginTop="-"+document.documentElement.clientHeight/2+"px",e.style.zIndex="100001",e.style.background="url("+V.imgUrl.loading+") no-repeat center center",parent.document.body.appendChild(e)}function r(e){var t=parent.document.getElementById(e);"undefined"!=typeof t&&null!=t&&t.parentNode.removeChild(t)}function c(){if($+=1,U==n){U=document.createElement("div"),U.style.position="fixed",U.style.top=0,U.style.left=0,U.style.width="100%",U.style.height="100%",U.style.zIndex="100",U.style.backgroundColor="#000000",U.style.zIndex="100000",U.style.opacity=.62,parent.document.body.appendChild(U);var e=a();8==e?U.style.cssText+="; -ms-filter: 'progid:DXImageTransform.Microsoft.Alpha(Opacity=72)';; filter = progid:DXImageTransform.Microsoft.Alpha(Opacity=72)":e>0&&e<=7?U.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=72)":U.style.opacity=.62}}function s(){1==$&&(parent.document.body.removeChild(U),U=n,$=0)}function a(){var t=e.navigator.userAgent,n=t.indexOf("MSIE");return n>0?parseInt(t.substring(n+5,t.indexOf(".",n))):0}function u(e){e&&(yt.webToken.servicePort=e)}function d(e){e&&(yt.webToken.language=e)}function f(e){yt.webToken.replayAttack=e}function y(e){if(null==e||S(e))return!1;var t=e.length;return h(e)||G(e)||0===t||"number"==typeof t&&t>0&&t-1 in e}function p(e,t,n){var i,o;if(e)if(k(e))for(i in e)"prototype"==i||"length"==i||"name"==i||e.hasOwnProperty&&!e.hasOwnProperty(i)||t.call(n,e[i],i,e);else if(G(e)||y(e)){var r="object"!=typeof e;for(i=0,o=e.length;i<o;i++)(r||i in e)&&t.call(n,e[i],i,e)}else if(e.forEach&&e.forEach!==p)e.forEach(t,n,e);else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e);return e}function l(){}function g(e){return"undefined"==typeof e}function v(e){return"undefined"!=typeof e}function m(e){return null!==e&&"object"==typeof e}function h(e){return"string"==typeof e}function T(e){return"number"==typeof e}function C(e){return"[object Date]"===Object.prototype.toString.call(e)}function k(e){return"function"==typeof e}function b(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function S(e){return e&&e.window===e}function E(e){return"[object File]"===Object.prototype.toString.call(e)}function w(e){return"[object Blob]"===Object.prototype.toString.call(e)}function I(e){return"boolean"==typeof e}function B(e,t){var i=t;return"string"==typeof e&&"$"===e.charAt(0)&&"$"===e.charAt(1)?i=n:S(t)?i="$WINDOW":t&&document===t&&(i="$DOCUMENT"),i}function D(e,t){return g(e)?n:JSON.stringify(e,B,t?"  ":null)}function K(e){return h(e)?JSON.parse(e):e}function A(){return!0}function O(e){for(var t=1,n=arguments.length;t<n;t++){var i=arguments[t];if(i)for(var o=Object.keys(i),r=0,c=o.length;r<c;r++){var s=o[r];e[s]=i[s]}}}function x(e){return new yt.util.ByteBuffer(e).data}function N(e,n){return new t.error(e,"get error code:"+e+" reason:"+n)}function P(e){var t,n;return t=ytcrypto.md.sha256.create().update(e),n=t.digest(),n.data}function R(e){var t=_.getHash(e),n=t.slice(0,16);t=_.getHash(t);var i=t.slice(0,16);return{key:i,iv:n}}function H(e,t,n,i){var o;o=i?ytcrypto.seed.createEncryptionCipher:ytcrypto.seed.createDecryptionCipher;var r=o(n,"CBC");return r.start(t),r.update(yt.util.createBuffer(e)),r.finish(),r.output.getBytes()}function F(e){var t=["RSA PRIVATE KEY","CERTIFICATE","PRIVATEKEY"];return t[e]}function L(e){var t,n,i=[],o=e.split("");for(t=0;t<e.length;t++){var r=cp949Table[o[t].charCodeAt()];n=r?yt.util.hexToBytes(r.toString(16)):o[t],i.push(n)}return i.join("")}function Y(e,t){var i,o=Object.keys(e);for(i=0;i<o.length;i++)if(e[o[i]]===t)return o[i];return n}function M(e){for(var t,n=0,i=[],o=yt.util.bytesToHex(e);n<o.length;){var r=o.substr(n,4),c=Y(cp949Table,parseInt("0x"+r));c?(n+=4,t=String.fromCharCode(c)):(n+=2,t=String.fromCharCode("0x00"+r.substr(0,2))),i.push(t)}return i.join("")}var U,_=e.vest||(e.vest={}),j={},V={},$=0,X={0:"kor",1:"eng",2:"jpn"},G=Array.isArray,W=function(e){return h(e)?e.trim():e},z={isMSIE:function(){return document.documentMode===n?e.navigator.userAgent.toLowerCase().indexOf("msie 7.0")!==-1&&7:document.documentMode||!1},isCompatiblilityMode:function(){return this.isMSIE()&&e.navigator.userAgent.toLowerCase().indexOf("trident")!==-1},isChrome:function(){return e.navigator.userAgent.toLowerCase().indexOf("chrome")!==-1},isFirefox:function(){return e.navigator.userAgent.toLowerCase().indexOf("firefox")!==-1},isSafari:function(){return e.navigator.userAgent.toLowerCase().indexOf("safari")!==-1},isOpera:function(){return e.navigator.userAgent.toLowerCase().indexOf("opr")!==-1},isSwing:function(){return e.navigator.userAgent.toLowerCase().indexOf("swing")!==-1},getBrowser:function(){var e="IE";return _.browser.isChrome()?e="CHROME":_.browser.isSafari()?e="SAFARI":_.browser.isFirefox()?e="FIREFOX":_.browser.isOpera()?e="OPERA":_.browser.isSwing()&&(e="SWING"),e}},J={isWindows:function(){return"win32"===e.navigator.platform.toLowerCase()||"win64"===e.navigator.platform.toLowerCase()},isMac:function(){return"macintel"===e.navigator.platform.toLowerCase()},isLinux32:function(){},isLinux64:function(){return"Linux x86_64"===e.navigator.platform.toLowerCase()}},q={encodeCharset:function(e,n){if(!h(e)||!h(n))return e;switch(n.toLowerCase()){case"euc-kr":return t.util.encodeEUCKR(e);case"utf-8":return t.util.encodeUTF8(e);case"cp949":return L(e);default:return e}},decodeCharset:function(e,n){if(!h(e)||!h(n))return e;switch(n.toLowerCase()){case"euc-kr":return t.util.euckrToUTF8(e);case"utf-8":return t.util.decodeUTF8(e);case"cp949":return M(e);default:return e}},pemToBase64:function(e){return h(e)?e.replace("-----BEGIN CERTIFICATE-----","").replace("-----END CERTIFICATE-----","").replace(/\r/gi,"").replace(/\n/gi,""):e},base64ToPem:function(e,t){var n="\n";n+="-----BEGIN "+F(t)+"-----\n";for(var i=0;i<e.length;i+=64)n+=e.substring(i,i+64)+"\n";return n+="-----END "+F(t)+"-----\n"},encodeBytes:function(e,i){if(e!==n&&""!=e)switch(i.toLowerCase()){case"hex":return t.util.bytesToHex(e);case"base64":return t.util.encode64(e);default:return t.util.bytesToHex(e)}},encodeArrayBuffer:function(e,i){if(e!==n&&""!=e){var o=ytcrypto.util.createBuffer(e).data;switch(i.toLowerCase()){case"hex":return t.util.bytesToHex(o);case"base64":return t.util.encode64(o);default:return t.util.bytesToHex(o)}}},decodeString:function(e,i){if(e!==n&&""!=e)switch(i.toLowerCase()){case"hex":return t.util.hexToBytes(e);case"base64":return t.util.decode64(e);default:return t.util.hexToBytes(e)}},decodeHex:function(e){if(e!==n&&""!=e)return t.util.hexToBytes(e)},hexDecimal:function(e,t){if(!h(e)||!h(t))return e},certToBase64:function(e){return t.util.encode64(yt.util.hexToBytes(e.toHex()))}},Q=function(e){function i(e){return m(e)&&e instanceof t.pki.Certificate||e.hasOwnProperty("certIdentifier")}function o(e){if(!i(e))throw"Not a Certificate"}function r(e){return e.isAfter(moment())}function c(e){var t=e.diff(moment(),"day");return 0==t&&Number(e.format("YYYYMMDDHHmmss"))-Number(moment().format("YYYYMMDDHHmmss"))<0?-1:t}function s(e,t){try{return e.decrypt(t)}catch(n){throw _.error("2200")}}function a(e,t){try{return e.encrypt(t)}catch(n){throw _.error("2201")}}function u(e){try{var n=t.asn1.fromString(e);return t.pkcs8.createEncryptedPrivateKeyInfoFromAsn1(n)}catch(i){throw"not a encrypted private key info"}}function d(e){try{var n=t.asn1.fromBytes(e);return t.pkcs8.createEncryptedPrivateKeyInfoFromAsn1(n)}catch(i){throw"not a encrypted private key info"}}function f(e,n){var i=t.asn1.fromDer(e),o=t.cms.createSignedData();o.fromAsn1(i,function(e){return e instanceof t.error?void n(_.error("2010",e.getReason())):void o.verify({},function(e){return e instanceof t.error?void n(_.error("2011",e.getReason())):void n(o.content)})})}function y(e,n,i,o){var r,c={};r=t.pki.Certificate.fromBytes(n),c.name="RSASSA-PKCS1-v1_5",c.hash={name:"SHA-256"},r.publicKey.verify(c,e,i,function(e){return e instanceof t.error?void o(_.error("2012",e.getReason())):void o(i)})}var l={AUTHORITY_KEY_IDENTIFIER:"2.5.29.35",SUBJECT_KEY_IDENTIFIER:"2.5.29.14",KEY_USAGE:"2.5.29.15",CERTIFICATE_POLICIES:"2.5.29.32",SUBJECT_ALTERNATIVE_NAME:"2.5.29.17",CRL_DISTRIBUTION_POINTS:"2.5.29.31",AUTHORITY_INFO_ACCESS:"1.3.6.1.5.5.7.1.1",EXTKEYUSAGE:"2.5.29.37",BASICCONSTRAINTS:"2.5.29.19"},g=function(e,i){var o,s,a,u,d,f,y,g,m,h,T,C,k,b,S,E,w,I,B,D,K,A,O,x,N=e._cert;o=N.version,s=e.serialNumber,a=yt.oids[N.signatureOid],u=t.util.bytesToHex(N.signature),d=e.issuer,f={to:moment(e.validity.notAfter),from:moment(e.validity.notBefore)},y=e.subject,a.toUpperCase().indexOf("RSA")!==-1&&"undefined"!=typeof N.publicKey.n&&(g="RSA "+N.publicKey.n.bitLength()),m=t.util.bytesToHex(yt._asn1.toDer(ytcrypto.pki.publicKeyToAsn1(N.publicKey)).getBytes()),h=yt.util.bytesToHex(ytcrypto.pki.publicKeyToAsn1(N.publicKey).value[1].value),h="00"==h.substr(0,2)?h.substr(2,h.length):h,p(N.extensions,function(e){switch(e.id){case l.AUTHORITY_KEY_IDENTIFIER:T=t.util.bytesToHex(e.value),D=t.util.bytesToHex(t.asn1.fromBytes(e.value)._asn.value[0].value);break;case l.CRL_DISTRIBUTION_POINTS:S=e.value.substr(e.value.indexOf("ldap://"));break;case l.AUTHORITY_INFO_ACCESS:I=yt._asn1.fromDer(e.value).value[0].value[1].value;break;case l.SUBJECT_KEY_IDENTIFIER:B=e.subjectKeyIdentifier;break;case l.EXTKEYUSAGE:for(var n in e)"1.2.410.200004.10.1.2"==n&&(A="id_kisa_HSM");break;case l.BASICCONSTRAINTS:var i="none",o="none";e.cA&&(i="CA"),""!=e.pathLenConstraint&&"undefined"!=typeof e.pathLenConstraint&&(o=e.pathLenConstraint),K="subject Type="+i+", path Length Contraint="+o}}),k=[],p(e.extensions.keyUsage,function(e,t){"name"!==t&&"value"!==t&&e&&k.push(t)}),C=e.extensions.certificatePolicies!=n&&e.extensions.certificatePolicies.policies!=n?Object.keys(e.extensions.certificatePolicies.policies)[0]:null,b=e.extensions.subjectAltName!=n?t.util.bytesToHex(e.extensions.subjectAltName.value):null,O=e.extensions.subjectAltName!=n?e.extensions.subjectAltName.realName:null,C&&(E=e.extensions.certificatePolicies.policies[C].userNotice,w=e.extensions.certificatePolicies.policies[C].CPSuri),x=i,this.getVersion=function(){return o+1+""},this.getSerialNumber=function(){return s},this.getSignatureAlgorithm=function(){return a},this.getSignatureValue=function(){return u},this.getIssuer=function(){return d},this.getValidityTo=function(e){return f.to.format(e)},this.getValidityFrom=function(e){return f.from.format(e)},this.getSubject=function(){return y},this.getPublickeyAlgorithm=function(){return g},this.getPublickey=function(){return m},this.getPubkey=function(){return h},this.getAuthorityKeyIdentifier=function(){return T},this.getPolicy=function(){return C},this.getKeyUsage=function(){return k},this.getSubjectAlternativeName=function(){return b},this.getCrlDistributionPoint=function(){return S},this.getUserNotice=function(){return E},this.getCps=function(){return w},this.getAuthorityInfoAccess=function(){return I},this.isValid=function(){return r(f.to)},this.getAvailableDays=function(){return c(f.to)},this.toHex=function(){return e.toAsn1().toHex()},this.getSubjectKeyIdentifier=function(){return B},this.getIssuerKeyIdentifier=function(){return D},this.getBasicConstranints=function(){return K},this.getExtKeyUsage=function(){return A},this.getRealName=function(){return O},this.getSaveCert=function(){return x},this.toShortCert=function(){return new v(e)}};g.fromHex=function(e){return new g(t.pki.Certificate.fromString(e))},g.fromBytes=function(e){return new g(t.pki.Certificate.fromBytes(e))};var v=function(e){var n,i,s,a,u,d,f="YYYY-MM-DD HH:mm:ss";o(e),e instanceof t.pki.Certificate?(n=e.subject,i=e.issuer,s=Object.keys(e.extensions.certificatePolicies.policies)[0],a=e.serialNumber,d=e.subject,u={to:moment(e.validity.notAfter),from:moment(e.validity.notBefore)}):(n=e.subject.split(", ").join(","),i=e.issuer.split(", ").join(","),s=e.policy.id.split(",")[0],a=e.serial.toLowerCase(),d={cert:e.certIdentifier,key:e.keyIdentifier,kmCert:e.kmCertIdentifier,kmKey:e.kmKeyIdentifier},u={to:moment(e.validTo,f),from:moment(e.validFrom,f)}),this.getSubject=function(){return n},this.getIssuer=function(){return i},this.getPolicy=function(){return s},this.getSerial=function(){return a},this.getIdentifier=function(){return d},this.getValidityTo=function(e){return u.to.format(e)},this.getValidityFrom=function(e){return u.from.format(e)},this.isValid=function(){return r(u.to)},this.getAvailableDays=function(){return c(u.to)}},h=function(n,i,o,r){function c(e,n,i,o){var r=t.cms.createSignedData(),c={key:n.privateKey,certificate:y};r.setContent(e),r.sign(c,function(e){e instanceof t.error&&o(_.error("2000",e.getReason())),i(r.toAsn1().toBytes())})}function u(e,t,n,i){var o={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};t.privateKey.sign(o,e,function(e){return e instanceof yt.error?void i(_.error("2001",e.getReason())):void n(e)})}function d(e,n,i,o){var r,c=t.cms.createSignedData(),s={key:n.privateKey,certificate:y};r=ytcrypto.md.sha256.create(),r.update(e),e=ytcrypto.pkcs1.createDigestInfo(r),c.setDigestInfo(e),c.sign(s,function(e){e instanceof t.error&&o(_.error("2002",e.getReason())),i(c.toAsn1().toBytes())})}function f(e,n){return t.util.hexToBytes(e.envelopeVid(n.idn,n.recipientCertificate))}var y,p,l,v,m=!1;y=n,p=i,o&&r&&(m=!0,l=o,v=r),this.getCertificate=function(){return new g(y)},this.toString=function(t){var n={};return"undefined"!=typeof t?(n={signCert:e.encodeBytes(y.toAsn1().toBytes(),t.encoding),signPri:e.encodeBytes(p.toAsn1().toBytes(),t.encoding)},m&&(n.kmCert=e.encodeBytes(l.toAsn1().toBytes(),t.encoding),n.kmPri=e.encodeBytes(v.toAsn1().toBytes(),t.encoding))):(n={signCert:y.toAsn1().toHex(),signPri:p.toAsn1().toHex()},m&&(n.kmCert=l.toAsn1().toHex(),n.kmPri=v.toAsn1().toHex())),D(n)},this.toObject=function(t){var n={signCert:e.encodeBytes(y.toAsn1().toBytes(),t.encoding),signPri:e.encodeBytes(p.toAsn1().toBytes(),t.encoding)};return m&&(n.kmCert=e.encodeBytes(l.toAsn1().toBytes(),t.encoding),n.kmPri=e.encodeBytes(v.toAsn1().toBytes(),t.encoding)),n},this.toPFX=function(n,i){return"undefined"==typeof i.algorithm&&(i.algorithm="3des"),e.encodeBytes(t.pkcs12.PFX.generateToAsn1(s(p,n),y,n,i).toBytes(),i.encoding)},this.makeSignature=function(n,i,o,r,a,y){var l="",g=function(i){a({signature:e.encodeBytes(i,r.encoding),vidMessage:""===l?"":e.encodeBytes(l,r.encoding),extentions:{dn:n.getSubject(),certificate:e.encodeBytes(t.util.hexToBytes(n.toHex()),r.encoding),r:"",realName:n.getRealName()}})};try{var v=s(p,o)}catch(m){y(m)}if(i=e.encodeCharset(i,r.charset),r.vid){var h=q.pemToBase64(r.vid.recipientCertificate);r.vid.recipientCertificate=q.base64ToPem(h,1),l=f(v,r.vid)}"undefined"!=typeof r.signtype&&0==r.signtype?u(i,v,g,y):"undefined"!=typeof r.signtype&&4==r.signtype?d(i,v,g,y):c(i,v,g,y)},this.changePassword=function(e,t,n,i){try{p=a(s(p,e),t)}catch(o){return void i(o)}n(!0)},this.verifyPin=function(e,t,n){try{s(p,e)}catch(i){return void n(i)}t(!0)}};h.fromString=function(e){var n=K(e);return n.kmCert&&n.kmPri?new h(t.pki.Certificate.fromString(n.signCert),u(n.signPri),t.pki.Certificate.fromString(n.kmCert),u(n.kmPri)):new h(t.pki.Certificate.fromString(n.signCert),u(n.signPri))},h.fromBytes=function(e){return e.kmCert&&e.kmPri?(new g.fromBytes(e.signCert),d(e.signPri),t.pki.Certificate.fromBytes(e.kmCert),d(e.kmPri)):new h(t.pki.Certificate.fromBytes(e.signCert),d(e.signPri))},h.fromPFX=function(n,i,o){var r,c,s,u,d,f;return f="undefined"!=typeof o?ytcrypto.util.bytesToHex(e.decodeString(n,o.encoding)):ytcrypto.util.bytesToHex(n),r=t.pkcs12.PFX.fromString(f,i),c=r.contents[r.contents.keys[0]].cert,s=a(r.contents[0].key,i),"undefined"!=typeof r.contents.keys[1]&&(u=r.contents[r.contents.keys[1]].cert,d=a(r.contents[1].key,i)),new h(c,s,u,d)};var T=function(n,i){n=e.encodeCharset(n,i.charset);var o;return o=new t.pki.PersonInfoReq(n),i.realName&&o.request("realName"),i.birthDate&&o.request("birthDate"),i.gender&&o.request("gender"),i.nationalInfo&&o.request("nationalInfo"),o=o.toAsn1(),o=o.toBytes()};return{Certificate:g,ShortCert:v,CertificateSet:h,generateUCPID:T,verifySignature:function(n,i,o,r,c){var s=function(n){return n instanceof t.error?void c(n):void r(e.decodeCharset(n,o.charset))};"object"==typeof i?y(e.decodeString(n,o.encoding),e.decodeString(i.certOrKey,o.encoding),e.encodeCharset(i.plain,o.charset),s):f(e.decodeString(n,o.encoding),s)}}}(q),Z=function(e,t,i,a){function u(e,t){k(t)?t(e):d(e)}function d(e){alert(e.getReason())}function f(e,t){var n=[];return G(t)&&t.forEach(function(t){(e===h.SYSTEM&&"DISK DRIVE"===t.type&&t.systemDrive||e===h.TOKEN&&("HARDWARE TOKEN"===t.type||"PKCS#11 TOKEN"===t.type)||e===h.LOCALDISK&&t.type===e&&!t.systemDrive||e===h.SAVETOKEN&&"SmartCard TOKEN"===t.type||e===h.PHONE&&"MobiSign"===t.type||e===h.PHONE&&"Mobile USIM"===t.type||e===h.PHONE&&"Ubikey"===t.type||e===h.SECUREDISK&&t.type===h.SECUREDISK||e===h.SAVETOKEN&&("SmartCard TOKEN"===t.type||"USBKey TOKEN"===t.type)||e===h.USBKEY&&"USBKey TOKEN"===t.type||e===h.PFXNPKI&&"PFX NPKI"===t.type||e===h.ALL)&&n.push(t)}),n}function y(t){return t instanceof e.error}function g(t,n,i,o){e.webToken.getTokenList(n,function(e){return y(e)?void u(e,o):void i(f(t,e))})}function m(e,t){for(var i="",o="",r="",c=e.split(","),s=0;s<c.length;s++){if(i="",o="",i=c[s].split("="),o="upper"==t?i[0].toUpperCase().replace(/\s/gi,""):"lower"==t?i[0].toLowerCase().replace(/\s/gi,""):i[0].replace(/\s/gi,""),i[1]==n);else for(var a=1;a<i.length;a++)o+="="+i[a];r+=o+","}return r.substr(0,r.length-1)}var h={ALL:"ALL",TOKEN:"TOKEN",SYSTEM:"SYSTEM DRIVE",LOCALDISK:"DISK DRIVE",UBIKEY:"UBIKEY",SAVETOKEN:"SmartCard TOKEN",PHONE:"PHONE",SECUREDISK:"Secure Disk",PFXNPKI:"PFX NPKI",USBKEY:"USBKey TOKEN",PKCS11:"PKCS#11 TOKEN"};return{TYPE:h,ERROR:e.webToken.error,getVersion:function(t,i){e.webToken.getVersion(n,function(e){return y(e)?void u(e,i):void(t||l)(e)})},getTokenList:function(e,t,n,i){var o,r,c,s;"function"==typeof t&&"function"==typeof n&&"undefined"==typeof i?(o=e,r={},c=t,s=n):"function"==typeof n&&"function"==typeof i&&(o=e,r=t,c=n,s=i),g(o,r,c,s)},getBackupedTokenList:function(t,n,i){e.webToken.getBackupedTokenList(function(e){return y(e)?void u(e,i):(e=f(t,e),p(e,function(e){"undefined"!=typeof e.SecureTokenIdentifier&&(e.tokenIdentifier=e.SecureTokenIdentifier,delete e.SecureTokenIdentifier)}),void n(e))})},getCertificates:function(t,c,s,a,d,f,g,v){var m={};s!==n&&0!=s&&(m.mode=s),a!==n&&0!=a&&(m.OID=a),d!==n&&0!=d&&(m.CAName=d),"undefined"!=typeof f.secureDiskList&&f.secureDiskList?e.webToken.getBackupedCertificateList(t,c,m,f,function(e){if(y(e))return void u(e,v);var t=[];p(e,function(e){t.push(new i.ShortCert(e))}),(g||l)(t)}):("TOKEN"==f.selectedToken&&o(),e.webToken.getCertificateList(t,c,m,f,function(e){if("TOKEN"==f.selectedToken&&r("yettie_library_loading"),y(e))return void u(e,v);var t=[];p(e,function(e){t.push(new i.ShortCert(e))}),(g||l)(t)}))},getCertificate:function(t,n,o,r){e.webToken.getCertificate(t,n,function(e){return y(e)?void u(e,r):void(o||l)(new i.Certificate(e.cert,e.path))})},getCACertificate:function(t,n,o,r,c){e.webToken.getCACertificate(t,n,function(t){if(y(t))return void u(t,c);var n="",s=t.rootCertHash;"ca"==o?n=t.caCertificate:"root"==o&&(n=t.rootCertificate),yt.pki.Certificate.fromBytes(e.util.decode64(n),function(e){(r||l)({cert:new i.Certificate(e),rootCertHash:s})})})},makeSignature:function(o,r,c,s,a,d,f){a=a?a:{};var p,g=new Array;if(!a.bytes)if("[object Array]"===Object.prototype.toString.call(s)){for(var v=new Array,m=0;m<s.length;m++)v[m]=s[m];for(;v.length>0;)g.push(t.encodeCharset(v.shift(),a.charset))}else g=t.encodeCharset(s,a.charset);if(a.vid&&a.vid.recipientCertificate&&(a.vid.recipientCertificate=t.pemToBase64(a.vid.recipientCertificate)),a.customStr){var h,T;h=ytcrypto.md.sha256.create(),h.update(a.customStr),T=h.digest(),a.customSID=t.encodeBytes(T.data,"base64")}"undefined"!=typeof a.signInputType&&2==a.signInputType&&(a.plainSizeLimit=10),"undefined"!=typeof a.signOutputType&&1==a.signOutputType&&(p=t.encodeCharset(a.outputfile,a.charset)),e.webToken.generateSignature(o,r,c.cert,c.key,g,p,a,function(r){if(y(r))return void u(r,function(e){f(e,d)});var s;if("undefined"!=typeof a.signOutputType&&1==a.signOutputType)s=t.decodeCharset(e.util.decode64(r.file),a.charset);else if("[object Array]"===Object.prototype.toString.call(r.signature)){var p=r.signature;for(s=[];p.length>0;)s.push(t.encodeBytes(p.shift(),a.encoding))}else s=t.encodeBytes(r.signature,a.encoding);"undefined"!=typeof r.usimCert?yt.pki.Certificate.fromBytes(e.util.decode64(r.usimCert),function(o){var c=new i.Certificate(o,"usim"),u=c.getRealName();(d||l)({signature:s,vidMessage:r.encryptedVIDRandom===n?"":t.encodeBytes(r.encryptedVIDRandom,a.encoding),extentions:{dn:r.encryptedVIDRandom===n?"":e.util.decodeUTF8(r.dn),certificate:t.encodeBytes(e.util.hexToBytes(c.toHex()),a.encoding),r:r.encryptedVIDRandom===n?"":t.encodeBytes(r.r,a.encoding),realName:u}})}):e.webToken.getCertificate(o,c.cert,function(o){if(y(r))return void u(r,function(e){f(e,d)});var c=new i.Certificate(o.cert,o.path),p=c.getRealName();(d||l)({signature:s,vidMessage:r.encryptedVIDRandom===n?"":t.encodeBytes(r.encryptedVIDRandom,a.encoding),extentions:{dn:r.encryptedVIDRandom===n?"":e.util.decodeUTF8(r.dn),certificate:t.encodeBytes(e.util.hexToBytes(c.toHex()),a.encoding),r:r.encryptedVIDRandom===n?"":t.encodeBytes(r.r,a.encoding),realName:p}})})})},makeSignatureFromKoscom:function(i,a,d,f,p,g,v){if(p=p?p:{},p.bytes||p.noCharSet||(f=t.encodeCharset(f,p.charset)),p.noCharSet&&(f=e.util.decode64(f),32!=f.length)){var m={};return m.code=35e3,m.message="",void u(m,function(e){v(e,g)})}if(p.vid&&p.vid.recipientCertificate&&(p.vid.recipientCertificate=t.pemToBase64(p.vid.recipientCertificate)),p.customStr){var h,T;h=ytcrypto.md.sha256.create(),h.update(p.customStr),T=h.digest(),p.customSID=t.encodeBytes(T.data,"base64")}"TOKEN"==p.selectedToken&&(c(),o()),e.webToken.generateSignatureFromKoscom(i,a,d.cert,d.key,f,p,function(i){return"TOKEN"==p.selectedToken&&(r("yettie_library_loading"),s()),y(i)?void u(i,function(e){v(e,g)}):void(g||l)({signature:t.encodeBytes(i.signature,p.encoding),vidMessage:i.encryptedVIDRandom===n?"":t.encodeBytes(i.encryptedVIDRandom,p.encoding),extentions:{dn:e.util.decodeUTF8(i.dn),certificate:t.encodeBytes(i.certificate,p.encoding),r:t.encodeBytes(i.r,p.encoding)}})})},verifySignature:function(n,i,o,r,c){var s;"undefined"!=typeof o.signInputType&&2==o.signInputType?(n=t.encodeCharset(n,o.charset),o.plainSizeLimit=10):n=t.decodeString(n,o.encoding),"undefined"!=typeof o.signOutputType&&1==o.signOutputType&&(s=t.encodeCharset(o.outputfile,o.charset)),"object"==typeof i&&("undefined"!=typeof i.certOrKey&&(i.certOrKey=t.decodeString(i.certOrKey,o.encoding)),"undefined"!=typeof i.plain&&(i.plain=t.encodeCharset(i.plain,o.charset))),e.webToken.verifySignature(n,s,i,o,function(n){if(y(n))return void u(n,c);var i;i="undefined"!=typeof o.signOutputType&&1==o.signOutputType?t.decodeCharset(e.util.decode64(n.file),o.charset):t.decodeCharset(e.util.decode64(n.verifyResult),o.charset),(r||l)(i)})},verifyData:function(o,r,c,s,a,d){"string"==typeof c.plain&&(c.plain=t.encodeCharset(c.plain,s.charset)),e.webToken.verifySignatureFromKoscom(o,c,s,function(c){if(y(c))return void u(c,d);if(1==r){var f=c.verifyResult,p=e.cms.createSignedData(),g=e.asn1.fromBytes(e.util.decode64(o)),v=function(o){if(y(o))return void u(o,d);o="";var r=new i.Certificate(p.certificates[0]);o+="$dn=",o+=m(r.getSubject(),"lower"),o+="$data=",o+=p.content!=n?t.decodeCharset(p.content,s.charset):t.decodeCharset(e.util.decode64(f),s.charset),o+="$serial=",o+=_.util.serialFilterForKoscom(r.getSerialNumber()),o+="$from=",o+=r.getValidityFrom("YYYY-MM-DD HH:mm:ss"),o+="$to=",o+=r.getValidityTo("YYYY-MM-DD HH:mm:ss"),"id_kisa_HSM"==r.getExtKeyUsage()&&(o+="$hsm=ok"),o+="$certificate=",o+=t.encodeBytes(yt.util.hexToBytes(r.toHex()),s.encoding),o+="$pubkey=",o+=t.encodeBytes(yt.util.hexToBytes(r.getPubkey()),s.encoding),(a||l)(o)};return void p.fromAsn1(g,v,n)}(a||l)(t.decodeCharset(e.util.decode64(c.verifyResult),s.charset))})},validateCertificate:function(t,i,o,r,c){""!=o&&o!=n||(o=2),e.webToken.ValidateCertificate(t,i.cert,o,function(e){return y(e)?void u(e,c):void(r||l)(e)})},setTokenOptions:function(t,n,i,o){e.webToken.setTokenOptions(t,n,function(e){return y(e)?void u(e,o):void(i||l)(!0)})},setIssueOptions:function(t,n,i,o,r,c,s,a,d){e.webToken.issueCertificate(t,n,i,o,r,c,s,function(e){return y(e)?void u(e,d):void(a||l)(e)})},updateCertificate:function(t,n,i,o,r,c,s,a,d,f){e.webToken.updateCertificate(t,n.cert,n.key,i,o,r,c,s,a,function(e){return y(e)?void u(e,f):void(d||l)(e)})},setRecoverOptions:function(t,n,i,o,r,c,s,a){e.webToken.recoverCertificate(t,n,i,o,r,c,function(e){return y(e)?void u(e,a):void(s||l)(e)})},getPCIdentityInfo:function(t,n,i,o){e.webToken.getPCIdentityInfo(t,n,function(e){return y(e)?void u(e,o):void(i||l)(e.pcidentity)})},getMacAddress:function(t,n,i){e.webToken.getMacAddress(t,function(e){return y(e)?void u(e,i):void(n||l)(e.mac)})},verifyPin:function(t,n,i,o,r){e.webToken.verifyPin(t,n.key,i,function(e){return y(e)?void u(e,r):void(o||l)(!0)})},changePin:function(t,n,i,o,r,c,s){e.webToken.changePin(t,n.cert,n.key,i,o,r,function(e){return y(e)?void u(e,s):void(c||l)(!0)})},importP12:function(t,n,i,o,r,c,s){e.webToken.importCertificate(t,n,i,o,r,function(e){return y(e)?void u(e,s):void(c||l)(!0)})},exportP12:function(t,n,i,o,r,c,s){e.webToken.exportCertificate(t,n.cert,n.key,i,o,r,function(e){if(y(e))return void u(e,s);var t=!0;v(e.pfxCert)&&(t=_.signHelper.encodeBytes(_.signHelper.decodeString(e.pfxCert,"base64"),r.encoding)),(c||l)(t)})},changeStorageMedia:function(t,n,i,a,d,f,p,g,v){"TOKEN"==p.selectedToken&&(c(),o()),e.webToken.changeStorage(t,n,i.cert,i.key,a,d,f,p,function(e){return"TOKEN"==p.selectedToken&&(r("yettie_library_loading"),s()),y(e)?void u(e,v):void(g||l)(!0)})},removeFromMedia:function(t,n,i,a,d,f){"TOKEN"==a.selectedToken&&(c(),o()),e.webToken.deleteCertificate(t,n,i.cert,i.key,function(e){return"TOKEN"==a.selectedToken&&(r("yettie_library_loading"),s()),y(e)?void u(e,f):void(d||l)(!0)})},suspend:function(t,n,i,o,r,c,s){r.reason=6,e.webToken.revokeCertificate(t,n.cert,n.key,i,o,r,function(e){return y(e)?void u(e,s):void(c||l)(!0)})},revoke:function(t,n,i,o,r,c,s){r.reason=1,e.webToken.revokeCertificate(t,n.cert,n.key,i,o,r,function(e){return y(e)?void u(e,s):void(c||l)(!0)})},setMatchedContext:function(n,i,o,c,a,d,f,p,g){var v,h,T;T=n,v=ytcrypto.md.sha256.create(),v.update(T),h=v.digest(),e.webToken.setMatchedContext(t.encodeBytes(h.data,"base64"),a,m(o,"upper"),c,d,f,function(e){if(r("yettie_library_loading"),y(e))return void u(e,g);for(var t in e.list){e.list[t].showRenewal=!1;var n=moment(e.list[t].validTo,"YYYYMMDDHHmmss"),i=n.diff(moment(),"day");0==i&&Number(n.format("YYYYMMDDHHmmss"))-Number(moment().format("YYYYMMDDHHmmss"))<0&&(i=-1),i>=0&&i<30&&(e.list[t].showRenewal=!0),e.list[t].exipreDay=i}(p||l)(e),s()})},unSetMatchedContext:function(n,i,o){var r,c;r=ytcrypto.md.sha256.create(),r.update(n),c=r.digest(),e.webToken.unsetMatchedContext(t.encodeBytes(c.data,"base64"),function(e){return y(e)?void u(e,o):void(i||l)(!0)})},makeCustomSession:function(n,i,a,d,f,p,g){var v,m;v=ytcrypto.md.sha256.create(),v.update(n),m=v.digest(),"TOKEN"==f.selectedToken&&(c(),o()),e.webToken.makeCustomSession(t.encodeBytes(m.data,"base64"),i,a.cert,a.key,d,function(e){return"TOKEN"==f.selectedToken&&(r("yettie_library_loading"),s()),y(e)?void u(e,g):void(p||l)(e)})},tray:function(t,n,i,o,r){e.webToken.operateTray(t,n,i,function(e){return y(e)?void u(e,r):void(o||l)(!0)})},getE2EInfo:function(t,n,i){e.webToken.getE2EInfo(t,function(e){if(y(e))return void u(e,i);var t={publicKey:"",sessionID:"",indexTable:""};if("undefined"!=typeof e.publicKey&&(t.publicKey=e.publicKey),"undefined"!=typeof e.sessionID&&(t.sessionID=e.sessionID),"undefined"!=typeof e.indexTable){var o=yt.util.decode64(e.indexTable);t.indexTable=o.split(",").map(String)}(n||l)(t)})},unload:function(){e.webToken.unLoad()},getHash:function(t,n,i,o,r){e.webToken.getHash(t,n,i,function(e){return y(e)?void u(e,r):void(o||l)(e.hash)})},encrypt:function(n,i,o,r,c,s){n=t.encodeCharset(n,r.charset),e.webToken.encrypt(n,i,o,function(e){return y(e)?void u(e,s):void(c||l)(t.encodeBytes(e,r.encoding))})},SecureEncode:function(n,i,o,r,c,s){n=t.encodeCharset(n,r.charset),e.webToken.encryptFromKoscom(n,i,o,r,function(e){return y(e)?void u(e,s):void(c||l)(t.encodeBytes(e,r.encoding))})},decrypt:function(n,i,o,r,c,s){n=t.decodeString(n,r.encoding),e.webToken.decrypt(n,i,o,function(e){return y(e)?void u(e,s):void(c||l)(t.decodeCharset(e,r.charset))})},SecureDecode:function(n,i,o,r,c,s){n=t.decodeString(n,r.encoding),e.webToken.decryptFromKoscom(n,i,o,r,function(e){return y(e)?void u(e,s):void(c||l)(t.decodeCharset(e,r.charset))})},envelope:function(n,i,o,r,c,s,a,d){"undefined"!=i&&""!=i||(r=0),n=t.encodeCharset(n,s.charset),"undefined"!==s.signOutputType&&1==s.signOutputType&&(o=t.encodeCharset(o,s.charset)),e.webToken.envelope(r,i,c.cert,n,o,s,function(e){if(y(e))return void u(e,d);var n=!0;n="undefined"!=typeof s.signOutputType&&1==s.signOutputType?t.decodeCharset(e,s.charset):t.encodeBytes(e,s.encoding),(a||l)(n)})},deenvelope:function(n,i,o,r,c,s,a,d,f){"undefined"!=typeof a.signInputType&&2==a.signInputType?(n=t.encodeCharset(n,a.charset),a.plainSizeLimit=10):n=t.decodeString(n,a.encoding),"undefined"!==a.signOutputType&&1==a.signOutputType&&(r=t.encodeCharset(r,a.charset)),e.webToken.deenvelope(c,o,s.key,i,n,r,a,function(e){return y(e)?void u(e,f):void(d||l)(t.decodeCharset(e,a.charset))})},koscomEnvelop:function(n,i,o,r,c,s,a){c.opFlag=r,o=q.pemToBase64(o),e.webToken.koscomEnvelop(n,t.encodeCharset(i,c.charset),o,c,function(e){if(y(e))return void u(e,a);var n="";0==r?n=t.encodeBytes(e.envelopedData,c.encoding):(1==(1&r)&&(n=e.sessionID+"$"+t.encodeBytes(e.envelopedData,c.encoding)),16==(240&r)&&(n=n.indexOf("$envelopData=")<0?t.encodeBytes(e.envelopedData,c.encoding)+"$"+t.encodeBytes(e.sessionKey,c.encoding):t.encodeBytes(e.sessionKey,c.encoding))),(s||l)(n)})},koscomDevelop:function(n,i,o,r,c,s,a,d){s.opFlag=c,e.webToken.koscomDevelop(n,i,o,r,s,function(e){if(y(e))return void u(e,d);var n="";0==c?n=t.decodeCharset(e.developedData,s.charset):1==(1&c)&&(n+="$data="+t.decodeCharset(e.developedData,s.charset),n+="$session="+t.encodeBytes(e.sessionKey,s.encoding)),(a||l)(n)})},koscomEncryptData:function(n,i,o,r,c,s){r.opFlag=o,e.webToken.koscomEncryptData(t.encodeCharset(n,r.charset),i,r,function(e){if(y(e))return void u(e,s);var n="";0==o?n=t.encodeBytes(e.encryptData,r.encoding):1==(1&o)&&(n=e.sessionID+"$"+t.encodeBytes(e.encryptData,r.encoding)),(c||l)(n)})},koscomDecryptData:function(n,i,o,r,c,s){r.opFlag=o,e.webToken.koscomDecryptData(n,i,r,function(e){if(y(e))return void u(e,s);var n=t.decodeCharset(e.decryptData,r.charset);(c||l)(n)})},relayRaonGetRefNum:function(t,n,i,o,r){e.webToken.relayRaonGetRefNum(t,n,i,function(e){return y(e)?void u(e,r):void(o||l)(e.refNum)})},relayRaonGetCert:function(t,n,i,o,r,c){e.webToken.relayRaonGetCert(t,n,i,o,function(e){return y(e)?void u(e,c):void(r||l)(!0)})},relayRaonExportCert:function(t,n,i,o,r,c,s){var a,d;n.kmCert==n.cert?(a="undefined",d="undefined",r.supportKm=0):(a=n.kmCert,d=n.kmKey,r.supportKm=1),e.webToken.relayRaonExportCert(t,n.cert,n.key,a,d,i,o,r,function(e){return y(e)?void u(e,s):void(c||l)(e)})},verifyVID:function(t,n,i,o,r,c){e.webToken.verifyVID(t,n.cert,n.key,i,o,function(e){
return y(e)?void u(e,c):void(r||l)(e)})},setLanguage:function(t){e.webToken.setLanguage(t)},setConfigFile:function(t,n,i){e.webToken.setConfigFile(t,function(e){return y(e)?void u(e,i):void(n||l)(e)})},getFilePath:function(n,i,o){e.webToken.getFilePath(n,function(e){return y(e)?void u(e,o):void(i||l)({str:t.decodeCharset(yt.util.decode64(e.path),"utf-8"),path:e.path,info:t.decodeCharset(yt.util.decode64(e.info),"utf-8")})})},setPFXNPKIFile:function(n,i,o,r,c,s){var a,d,f;f=r.customSID,a=ytcrypto.md.sha256.create(),a.update(f),d=a.digest(),e.webToken.setPFXNPKIFile(n,i,o,t.encodeBytes(d.data,"base64"),m(r.dn,"upper"),r.suffix,r.type,r,function(e){return y(e)?void u(e,s):void(c||l)(e.subjectDN)})},BackupSecureDiskCertificate:function(t,n,i,o,r,c,s){e.webToken.BackupSecureDiskCertificate(t,n,i.cert,i.key,o,r,function(e){return y(e)?void u(e,s):void(c||l)(!0)})},RestoreSecureDiskCertificate:function(t,n,i,o,r,c,s){e.webToken.RestoreSecureDiskCertificate(t,n,i.cert,i.key,o,r,function(e){return y(e)?void u(e,s):void(c||l)(!0)})},getTokenType:function(e){return"undefined"==typeof e.tokenType?void 0:"DISK DRIVE"===e.tokenType&&e.systemDrive?_.token.TYPE.SYSTEM:"DISK DRIVE"!==e.tokenType||e.systemDrive?"PKCS#11 TOKEN"===e.tokenType||"HARDWARE TOKEN"===e.tokenType?_.token.TYPE.TOKEN:"Ubikey"===e.tokenType?_.token.TYPE.UBIKEY:"SmartCard TOKEN"===e.tokenType?_.token.TYPE.SAVETOKEN:"USBKey TOKEN"===e.tokenType?_.token.TYPE.USBKEY:void 0:_.token.TYPE.LOCALDISK},CheckComplexPin:function(t,n,i,o,r,c){var s=[];"undefined"!=typeof t&&s.push(t),"undefined"!=typeof n&&s.push(n),"undefined"!=typeof i&&s.push(i),e.webToken.CheckComplexPin(s,o,function(e){return y(e)?void u(e,c):void(r||l)(!0)})},getSmartCardList:function(n,i,o,r){var c,s;c=ytcrypto.md.sha256.create(),c.update(n),s=c.digest(),e.webToken.GetSmartCardList(t.encodeBytes(s.data,"base64"),i,function(e){return y(e)?void u(e,r):void(o||l)(e)})},certificateSynchronize:function(t,n,i,o,r,c,s){e.webToken.CertificateSynchronize(t,n.key,i,o,r,function(e){return y(e)?void u(e,s):void(c||l)(!0)})},getHSMList:function(n,i,o,r){var c,s;c=ytcrypto.md.sha256.create(),c.update(n),s=c.digest(),e.webToken.GetHSMList(t.encodeBytes(s.data,"base64"),i,function(t){if(y(t))return void u(t,r);for(var n=[],i=0;i<t.length;i++)n[i]={name:t[i].name,path:e.util.decode64(t[i].path),tokenIdentifier:t[i].tokenIdentifier};(o||l)(n)})},setHSM:function(t,n,i,r){"undefined"!=typeof t&&(c(),o()),e.webToken.SetHSM(t,n,function(e){return y(e)?void u(e,r):void(i||l)(!0)})},generateFileSignature:function(n,i,o,r,c,s,a,d,f){if(a.outToFile=1==c||"1"==c?"1":"0",a.mode=1==s||"1"==s?"1":"0",a.customStr){var p,g;p=ytcrypto.md.sha256.create(),p.update(a.customStr),g=p.digest(),a.customSID=t.encodeBytes(g.data,"base64")}e.webToken.GenerateFileSignature(n,i,o.cert,o.key,t.encodeCharset(r,"utf-8"),a,function(n){if(y(n))return void u(n,f);var i="";i="0"==c&&"0"==s?t.encodeBytes(e.util.decode64(n.signature),a.encoding):"0"==c&&"1"==s?"$DN="+e.util.decodeUTF8(e.util.decode64(n.dn))+"$Data="+t.encodeBytes(e.util.decode64(n.signature),a.encoding):"1"==c&&"0"==s?e.util.decodeUTF8(e.util.decode64(n.signature)):"1"==c&&"1"==s?"$DN="+e.util.decodeUTF8(e.util.decode64(n.dn))+"$file="+e.util.decodeUTF8(e.util.decode64(n.signature)):n,(d||l)(i)})},verifyFileSignature:function(n,i,o,r,c,s){var a="";1==n?a=t.encodeBytes(t.encodeCharset(i,"utf-8"),"base64"):0==n&&(a=i),e.webToken.VerifyFileSignature(n,a,o,function(t){return y(t)?void u(t,s):void(c||l)(e.util.decodeUTF8(e.util.decode64(t.path)))})},CloseSessionAndLogoutWithP11:function(t,n){e.webToken.CloseSessionAndLogoutWithP11(function(e){return y(e)?void u(e,n):void(t||l)(!0)})},KoscomFileEnvelop:function(t,n,i,o,r){n=q.pemToBase64(n),e.webToken.KoscomFileEnvelop(t,n,i,function(e){return y(e)?void u(e,r):void(o||l)(!0)})},KoscomFileDevelop:function(t,i,o,r,c,s,a){e.webToken.KoscomFileDevelop(t,i,o.key,r,n,function(e){return y(e)?void u(e,a):void(s||l)(!0)})},GetCertificateListWithDN:function(t,i,o,r){e.webToken.GetCertificateListWithDN(t,n,function(e){return y(e)?void u(e,r):void(o||l)(e)})}}}(yt,q,Q,V);O(_,{version:j,init:i,setPort:u,forEach:p,isUndefined:g,isDefined:v,isObject:m,isString:h,isNumber:T,isDate:C,isArray:G,isFunction:k,isRegExp:b,isWindow:S,isFile:E,isBlob:w,isBoolean:I,trim:W,toJson:D,fromJson:K,isSSL:A,browser:z,os:J,getHash:P,error:N,noop:l,extend:O,signHelper:q,encryptSEED:H,vestKDF:R,arrayBufferToData:x,pki:Q,token:Z})}(window,yt),"undefined"!=typeof secureCertificateStorage&&(vest.secureCertificateStorage=secureCertificateStorage),"undefined"!=typeof Sloth&&(vest.sloth=Sloth),parent.window.vest=vest;